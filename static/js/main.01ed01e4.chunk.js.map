{"version":3,"sources":["game/loaders/modelLoader.ts","infrastructure/compareHelper.ts","infrastructure/decorators/propertyIsDirty.ts","game/worldEnviroment.ts","game/gameObjects/gameObjectWorldData.ts","game/gameObjects/moveableGameObject.ts","game/gameObjects/gameObject.ts","infrastructure/logger.ts","game/services/gameStateDataService.ts","game/gameWorld.ts","game/gameRenderer.ts","game/controls/cameraOrbitControls.ts","game/controls/cameraMapControls.ts","game/controls/worldInteractionControls.ts","game/controls/gameControls.ts","game/helpers/object3dHelper.ts","assets/icons/tower-icon.svg","game/index.ts","components/ui/icons/withSvgIcon.tsx","assets/icons/well-icon.svg","components/ui/icons/index.ts","containers/game/components/basicUI.tsx","containers/game/index.tsx","containers/home/index.tsx","containers/index.tsx","index.tsx"],"names":["ModelLoader","baseUrl","gltfLoader","dracoLoader","loadedModels","initialize","loadModels","models","completeCallback","loadCount","forEach","m","loadModel","loadedModel","name","onLoaded","length","gameModel","callback","load","path","gltf","object","scene","this","GLTFLoader","DRACOLoader","CompareHelper","shallowEqual","object1","object2","undefined","keys1","Object","keys","keys2","filter","k","PropertyIsDirty","method","target","propertyKey","privateKey","toString","defineProperty","set","value","oldValue","isDirty","isAnyDirty","get","enumerable","configurable","WorldEnviromentDebugEnum","GameObjectWorldData","clearDirty","position","x","y","z","rotation","destination","selected","highlighted","MoveableGameObject","movementSpeed","destinationReached","getDistanceToMove","source","delta","newPostion","moveDistance","diff","Math","abs","time","worldData","move","key","model","textContainer","lastTextUpdate","selectedCircleMesh","circle","show","event","color","material","getHex","targetColor","visible","setHex","geometry","RingGeometry","MeshBasicMaterial","Mesh","PI","document","createElement","className","style","marginTop","textLabel","CSS2DObject","newGroup","Group","add","clone","userData","gameObjectKey","timeStr","round","xStr","toFixed","zStr","innerHTML","logger","Date","getTime","log","message","GameStateDataService","apiUri","wsUri","socket","messageHandlers","connectToWebsocket","userId","Promise","resolve","reject","fetch","mode","headers","Accept","body","JSON","stringify","user_id","then","r","json","url","WebSocket","onopen","onmessage","onMessageRecived","catch","createUnit","send","CreateUnit","setUnitPosition","id","SetUnitPosition","setUnitDestination","SetUnitDestination","fetchInitialGameState","response","state","addMessageHandler","type","handler","notifyHandlers","h","e","msg","parse","data","process","WorldEnviroment","debugOptions","ambientLight","AmbientLight","light","DirectionalLight","castShadow","shadow","bias","mapSize","width","height","d","camera","left","right","top","bottom","far","groundTexture","TextureLoader","wrapS","RepeatWrapping","wrapT","repeat","anisotropy","encoding","sRGBEncoding","groundMaterial","MeshLambertMaterial","map","groundMesh","PlaneGeometry","receiveShadow","background","Color","fog","Fog","initializeDebug","setDebug","debug","ShowSmallGrid","smallGrid","GridHelper","ShowMediumGrid","mediumGrid","linewidth","ShowLargeGrid","largeGrid","GameWorld","setGameObjectWorldDataListeners","gameObjects","worldEnviroment","update","gm","addGameObject","gameObject","addSetGameObjectWorldDataListener","prop","notifySetGameObjectWorldDataListener","li","setGameObjectWorldData","g","setSelectedGameObjectsWorldData","forEachSelectedGameObject","go","setSelectedGameObjectsDestination","getSceneIntersection","raycaster","intersectObject","getGameObjectIntersection","intersects","intersectObjects","intersectedModel","intersection","getGameObjectRoot","hoverGameObject","find","selectGameObject","removeExsistingSelection","getGameObjectByKey","objects","parent","GameRenderer","container","renderer","labelRenderer","clock","stats","fps","lastRender","now","updateTargets","setPixelRatio","window","devicePixelRatio","setSize","innerWidth","innerHeight","outputEncoding","shadowMap","enabled","domElement","addEventListener","handleWindowResize","appendChild","dom","aspect","updateProjectionMatrix","addUpdateTarget","updateTarget","start","requestAnimationFrame","renderLoop","lastRenderDiff","interval","getDelta","render","WebGLRenderer","antialias","Clock","CSS2DRenderer","Stats","changeEvent","startEvent","endEvent","warn","CameraMapControls","screenSpacePanning","mouseButtons","LEFT","MOUSE","PAN","RIGHT","ROTATE","touches","ONE","TOUCH","TWO","DOLLY_ROTATE","minDistance","maxDistance","minZoom","maxZoom","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panSpeed","keyPanSpeed","autoRotate","autoRotateSpeed","target0","position0","zoom0","domElementKeyEvents","getPolarAngle","getAzimuthalAngle","listenToKeyEvents","saveState","reset","dispose","Vector3","Infinity","UP","BOTTOM","MIDDLE","DOLLY","DOLLY_PAN","zoom","spherical","phi","theta","onKeyDown","scope","copy","dispatchEvent","STATE","NONE","offset","quat","Quaternion","setFromUnitVectors","up","quatInverse","invert","lastPosition","lastQuaternion","twoPI","sub","applyQuaternion","setFromVector3","rotateLeft","sphericalDelta","min","max","Number","isFinite","makeSafe","radius","scale","addScaledVector","panOffset","setFromSpherical","lookAt","multiplyScalar","zoomChanged","distanceToSquared","EPS","dot","quaternion","removeEventListener","onContextMenu","onPointerDown","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","ownerDocument","onPointerMove","onPointerUp","TOUCH_ROTATE","TOUCH_PAN","TOUCH_DOLLY_PAN","TOUCH_DOLLY_ROTATE","Spherical","rotateStart","Vector2","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","pow","angle","rotateUp","panLeft","v","distance","objectMatrix","setFromMatrixColumn","panUp","crossVectors","pan","deltaX","deltaY","element","isPerspectiveCamera","targetDistance","tan","fov","clientHeight","matrix","dollyOut","dollyScale","dollyIn","handleMouseDownRotate","clientX","clientY","handleMouseDownPan","handleTouchStartRotate","pageX","pageY","handleTouchStartPan","handleTouchStartDolly","dx","dy","sqrt","handleTouchMoveRotate","subVectors","handleTouchMovePan","handleTouchMoveDolly","pointerType","preventDefault","focus","mouseAction","button","handleMouseDownDolly","ctrlKey","metaKey","shiftKey","onMouseDown","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","onMouseMove","onMouseUp","handleMouseWheel","needsUpdate","code","handleKeyDown","handleTouchStartDollyPan","handleTouchStartDollyRotate","handleTouchMoveDollyPan","handleTouchMoveDollyRotate","passive","EventDispatcher","WorldInteractionControls","gameWorld","handleClick","handleMouseMove","getMouseRaycaster","Raycaster","mouse","setFromCamera","intersecs","handleLeftClick","handleRightClick","point","GameControls","cameraMapControls","worldInteractionControls","timer","Object3DHelper","cloneObject3D","recursive","cloneMaterials","newObject","traverse","mesh","isMesh","cloneMaterial","setShadows","newMaterial","Array","isArray","im","isMaterial","_path","_path2","_path3","Game","gameRenderer","gameControls","modelLoader","gameStateDataService","connectToServer","connectionAtempt","handleConnectedToServer","connected","handleServerCreateUnit","handleServerSetUnitDestination","handleServerSetUnitPosition","setTimeout","pos","createMoveableTower","handleLoadModelsCompleted","resp","unit","handleActionbarButtonClicked","tower","setScalar","well","handleGameObjectReachedDestination","obj","posX","posZ","createMoveableGameObject","createMoveableWell","modelKey","gameObj","Scene","PerspectiveCamera","withSvgIcon","WrappedSvgIcon","defaultProps","defaultPropValues","fill","props","svgProps","PureComponent","_excluded","_extends","assign","i","arguments","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgTowerIcon","_ref","svgRef","title","titleId","xmlns","viewBox","xmlSpace","ref","ForwardRef","SvgWellIcon","TowerIcon","TowerIconSVG","WellIcon","WellIconSVG","BasicUI","handleButtonClick","onClickButton","nativeEvent","onClick","GameContainer","initialized","game","gameContainer","initGame","HomeContainer","padding","to","fontSize","App","basename","exact","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.01ed01e4.chunk.js","sourcesContent":["import { Object3D } from 'three'\nimport { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader'\n\nexport interface GameModel {\n\tpath: string\n\tname: string\n\tonLoaded?: (model: LoadedGameModel) => void\n}\nexport interface LoadedGameModel extends GameModel {\n\tobject: Object3D\n}\n\nexport interface LoadedModels {\n\t[property: string]: LoadedGameModel\n}\nclass ModelLoader {\n\tprivate baseUrl: string\n\n\tprivate gltfLoader: GLTFLoader\n\n\tprivate dracoLoader: DRACOLoader\n\n\tpublic loadedModels: LoadedModels\n\n\tconstructor(baseUrl = '') {\n\t\tthis.baseUrl = baseUrl\n\t\tthis.gltfLoader = new GLTFLoader()\n\t\tthis.dracoLoader = new DRACOLoader()\n\t\tthis.loadedModels = {}\n\t}\n\n\tpublic initialize = (): void => {\n\t\t// this.dracoLoader.setDecoderPath('/assets/draco/')\n\t\t// this.gltfLoader.setDRACOLoader(this.dracoLoader)\n\t}\n\n\tpublic loadModels = (models: GameModel[], completeCallback: (loadedModels: LoadedModels) => void): void => {\n\t\tlet loadCount = 0\n\t\tmodels.forEach((m) => {\n\t\t\tthis.loadModel(m, (loadedModel) => {\n\t\t\t\tthis.loadedModels = {\n\t\t\t\t\t...this.loadedModels,\n\t\t\t\t\t[loadedModel.name]: loadedModel\n\t\t\t\t}\n\t\t\t\tloadCount += 1\n\t\t\t\tif (m.onLoaded) {\n\t\t\t\t\tm.onLoaded(loadedModel)\n\t\t\t\t}\n\t\t\t\tif (loadCount === models.length) {\n\t\t\t\t\tcompleteCallback(this.loadedModels)\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\tprivate loadModel = (gameModel: GameModel, callback: (model: LoadedGameModel) => void): void => {\n\t\tthis.gltfLoader.load(`${this.baseUrl}${gameModel.path}`, (gltf) => {\n\t\t\tcallback({\n\t\t\t\t...gameModel,\n\t\t\t\tobject: gltf.scene\n\t\t\t})\n\t\t})\n\t}\n}\n\nexport default ModelLoader\n","class CompareHelper {\n\tpublic static shallowEqual = <T>(object1: T | undefined, object2: T | undefined): boolean => {\n\t\tif (object1 === undefined && object2 === undefined) return true\n\t\tif (object1 === undefined || object2 === undefined) return false\n\t\tconst keys1 = Object.keys(object1)\n\t\tconst keys2 = Object.keys(object2)\n\n\t\tif (keys1.length !== keys2.length) {\n\t\t\treturn false\n\t\t}\n\t\tif (keys1.filter((k) => object1[k as keyof T] !== object2[k as keyof T]).length > 0) {\n\t\t\treturn false\n\t\t}\n\n\t\treturn true\n\t}\n}\nexport default CompareHelper\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport CompareHelper from '../compareHelper'\n\nexport type DirtyProps<T> = {\n\t[K in keyof T as K]?: boolean\n}\nexport type IDirtyable<T> = {\n\tisDirty: DirtyProps<T>\n\tisAnyDirty: boolean\n\tclearDirty: () => void\n}\n\ntype GenericPropertyDescriptorMap<T> = PropertyDescriptorMap & ThisType<T> & any\ntype TypedPropertyDecorator<T extends IDirtyable<T>, K extends keyof T = keyof T> = (target: T, propertyKey: K) => GenericPropertyDescriptorMap<T>\ntype DirtyMethod = 'normal' | 'shalowCompare'\nexport function PropertyIsDirty(method: DirtyMethod = 'normal'): TypedPropertyDecorator<any> {\n\treturn <T extends IDirtyable<T>, K extends keyof T>(target: T, propertyKey: K) => {\n\t\tconst privateKey = `_${propertyKey.toString()}` as keyof T\n\t\treturn Object.defineProperty(target, propertyKey, {\n\t\t\tset(this: T, value) {\n\t\t\t\tconst oldValue = this[privateKey]\n\t\t\t\tif ((method === 'normal' && oldValue !== value) || (method === 'shalowCompare' && !CompareHelper.shallowEqual(oldValue, value))) {\n\t\t\t\t\tif (!this.isDirty) {\n\t\t\t\t\t\tthis.isDirty = {}\n\t\t\t\t\t}\n\t\t\t\t\tthis.isDirty[propertyKey] = true\n\t\t\t\t\tthis.isAnyDirty = true\n\t\t\t\t\tthis[privateKey] = value\n\t\t\t\t}\n\t\t\t},\n\t\t\tget() {\n\t\t\t\treturn this[privateKey]\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t\tconfigurable: true\n\t\t})\n\t}\n}\n","import { AmbientLight, Color, DirectionalLight, Fog, GridHelper, LineBasicMaterial, Mesh, MeshLambertMaterial, PlaneGeometry, RepeatWrapping, Scene, sRGBEncoding, TextureLoader } from 'three'\n\nexport enum WorldEnviromentDebugEnum {\n\tShowSmallGrid,\n\tShowMediumGrid,\n\tShowLargeGrid\n}\nclass WorldEnviroment {\n\tprivate scene: Scene\n\n\tprivate debugOptions: {\n\t\t[key in keyof typeof WorldEnviromentDebugEnum]?: boolean\n\t}\n\n\tconstructor(scene: Scene) {\n\t\tthis.scene = scene\n\t\tthis.debugOptions = {}\n\t}\n\n\tpublic initialize = (): void => {\n\t\t// lights\n\t\tconst ambientLight = new AmbientLight(0x666666, 0.6)\n\t\tthis.scene.add(ambientLight)\n\n\t\tconst light = new DirectionalLight(0xdfebff, 0.7)\n\t\tlight.position.set(500, 800, 500)\n\n\t\tlight.castShadow = true\n\t\tlight.shadow.bias = -0.0001\n\t\tlight.shadow.mapSize.width = 10000\n\t\tlight.shadow.mapSize.height = 10000\n\n\t\tconst d = 500\n\n\t\tlight.shadow.camera.left = -d\n\t\tlight.shadow.camera.right = d\n\t\tlight.shadow.camera.top = d\n\t\tlight.shadow.camera.bottom = -d\n\n\t\t// light.shadow.camera.near = 10\n\t\tlight.shadow.camera.far = 2000\n\n\t\tthis.scene.add(light)\n\n\t\t// ground\n\t\tconst textureLoader = new TextureLoader()\n\t\tconst groundTexture = textureLoader.load('assets/textures/terrain/grasslight-big.jpg')\n\n\t\tgroundTexture.wrapS = RepeatWrapping\n\t\tgroundTexture.wrapT = RepeatWrapping\n\t\tgroundTexture.repeat.set(200, 200)\n\t\tgroundTexture.anisotropy = 16\n\t\tgroundTexture.encoding = sRGBEncoding\n\n\t\tconst groundMaterial = new MeshLambertMaterial({ map: groundTexture })\n\t\tconst groundMesh = new Mesh(new PlaneGeometry(1000, 1000), groundMaterial)\n\n\t\tgroundMesh.rotation.x = -Math.PI / 2\n\t\tgroundMesh.receiveShadow = true\n\t\tthis.scene.add(groundMesh)\n\n\t\t// sky and fog\n\t\tthis.scene.background = new Color(0xcce0ff)\n\t\tthis.scene.fog = new Fog(0xcce0ff, 75, 150)\n\n\t\t// this.scene.environment = pmremGenerator.fromScene(new RoomEnvironment()).texture\n\t\t// this.scene.fog = new THREE.Fog(0xcccccc, 10, 50)\n\t\tthis.initializeDebug()\n\t}\n\n\tpublic setDebug = (...debug: WorldEnviromentDebugEnum[]): void => {\n\t\tdebug.forEach((d) => {\n\t\t\tthis.debugOptions = {\n\t\t\t\t...this.debugOptions,\n\t\t\t\t[WorldEnviromentDebugEnum[d]]: true\n\t\t\t}\n\t\t})\n\t}\n\n\tprivate initializeDebug = (): void => {\n\t\tif (this.debugOptions.ShowSmallGrid) {\n\t\t\tconst smallGrid = new GridHelper(1000, 1000, 0xcccccc, 0xcccccc)\n\t\t\tthis.scene.add(smallGrid)\n\t\t}\n\n\t\tif (this.debugOptions.ShowMediumGrid) {\n\t\t\tconst mediumGrid = new GridHelper(1000, 100, 0x333333, 0x333333)\n\t\t\tconst mediumGridMaterial = mediumGrid.material as LineBasicMaterial\n\t\t\tmediumGridMaterial.linewidth = 3\n\t\t\tthis.scene.add(mediumGrid)\n\t\t}\n\n\t\tif (this.debugOptions.ShowLargeGrid) {\n\t\t\tconst largeGrid = new GridHelper(1000, 10, 0x999999, 0x999999)\n\t\t\tconst largeGridMaterial = largeGrid.material as LineBasicMaterial\n\t\t\tlargeGridMaterial.linewidth = 5\n\t\t\tthis.scene.add(largeGrid)\n\t\t}\n\t}\n}\n\nexport default WorldEnviroment\n","import { DirtyProps, IDirtyable, PropertyIsDirty } from '../../infrastructure/decorators/propertyIsDirty'\n\nexport interface ICordinates {\n\tx: number\n\ty: number\n\tz: number\n}\nexport interface IGameObjectWorldData extends IDirtyable<IGameObjectWorldData> {\n\tposition: ICordinates\n\trotation: ICordinates\n\tdestination: ICordinates\n\tselected: boolean\n\thighlighted: boolean\n}\nclass GameObjectWorldData implements IGameObjectWorldData {\n\tconstructor() {\n\t\tthis.isDirty = {}\n\t\tthis.position = { x: 0, y: 0, z: 0 }\n\t\tthis.rotation = { x: 0, y: 0, z: 0 }\n\t\tthis.destination = this.position\n\t\tthis.selected = false\n\t\tthis.highlighted = false\n\t}\n\n\tpublic isAnyDirty = false\n\n\tpublic isDirty: DirtyProps<IGameObjectWorldData>\n\n\tpublic clearDirty = (): void => {\n\t\tthis.isDirty = {}\n\t\tthis.isAnyDirty = false\n\t}\n\n\t@PropertyIsDirty('shalowCompare')\n\tpublic position: ICordinates\n\n\t@PropertyIsDirty('shalowCompare')\n\tpublic rotation: ICordinates\n\n\t@PropertyIsDirty('shalowCompare')\n\tpublic destination: ICordinates\n\n\t@PropertyIsDirty()\n\tpublic selected: boolean\n\n\t@PropertyIsDirty()\n\tpublic highlighted: boolean\n}\n\nexport default GameObjectWorldData\n","import GameObject, { IGameObject } from './gameObject'\nimport { ICordinates } from './gameObjectWorldData'\n\nexport type IMoveableGameObject = IGameObject\n\nclass MoveableGameObject extends GameObject implements IMoveableGameObject {\n\tpublic movementSpeed = 5\n\n\tpublic destinationReached?: (obj: this) => void\n\n\t// constructor(key: string, model: Object3D, worldData: IGameObjectWorldData | undefined) {\n\t// \tsuper(key, model, worldData)\n\t// }\n\n\tpublic update(time: number, delta: number): void {\n\t\t// const updateData = this.updateData<IGameObjectWorldData>()\n\t\t// updateData('destination')\n\n\t\tconst { worldData } = this\n\t\tif (worldData.position.x !== worldData.destination.x || worldData.position.z !== worldData.destination.z) {\n\t\t\tworldData.position = this.move(worldData.position, worldData.destination, delta)\n\t\t\tif (worldData.position.x === worldData.destination.x && worldData.position.z === worldData.destination.z) {\n\t\t\t\tif (this.destinationReached) {\n\t\t\t\t\tthis.destinationReached(this)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsuper.update(time, delta)\n\t\t// updateData('position')\n\t}\n\n\tprivate move(source: ICordinates, destination: ICordinates, delta: number): ICordinates {\n\t\treturn {\n\t\t\tx: this.getDistanceToMove(source.x, destination.x, delta),\n\t\t\ty: this.getDistanceToMove(source.y, destination.y, delta),\n\t\t\tz: this.getDistanceToMove(source.z, destination.z, delta)\n\t\t}\n\t}\n\n\tprivate getDistanceToMove = (source: number, destination: number, delta: number): number => {\n\t\tlet newPostion: number = source\n\t\tlet moveDistance = delta * this.movementSpeed\n\t\tconst diff = Math.abs(destination - source)\n\t\tif (diff === 0) {\n\t\t\treturn destination\n\t\t}\n\t\tif (diff < moveDistance) {\n\t\t\tmoveDistance = diff\n\t\t}\n\t\tif (source > destination) {\n\t\t\tnewPostion = source - moveDistance\n\t\t}\n\t\tif (source < destination) {\n\t\t\tnewPostion = source + moveDistance\n\t\t}\n\t\treturn newPostion\n\t}\n}\nexport default MoveableGameObject\n","import { Group, Mesh, MeshBasicMaterial, Object3D, RingGeometry } from 'three'\nimport { CSS2DObject } from 'three/examples/jsm/renderers/CSS2DRenderer'\nimport GameObjectWorldData, { IGameObjectWorldData } from './gameObjectWorldData'\n\nexport interface IGameObject {\n\tworldData: IGameObjectWorldData\n\tmodel: Object3D\n\tkey: string\n\tupdate: (time: number, delta: number) => void\n}\nclass GameObject implements IGameObject {\n\tpublic key: string\n\n\tpublic model: Object3D\n\n\tpublic textContainer: HTMLDivElement\n\n\tpublic lastTextUpdate = 0\n\n\tpublic selectedCircleMesh: Mesh<RingGeometry, MeshBasicMaterial>\n\n\tpublic worldData: IGameObjectWorldData\n\n\t// protected renderedWorldData: IGameObjectWorldData\n\n\tconstructor(key: string, model: Object3D, worldData: IGameObjectWorldData | undefined = undefined) {\n\t\tthis.key = key\n\t\tif (worldData) {\n\t\t\tthis.worldData = worldData\n\t\t} else {\n\t\t\tthis.worldData = new GameObjectWorldData()\n\t\t}\n\n\t\tconst geometry = new RingGeometry(3.5, 3.6, 32)\n\t\tconst material = new MeshBasicMaterial({ color: 0x3336699 })\n\t\tthis.selectedCircleMesh = new Mesh<RingGeometry, MeshBasicMaterial>(geometry, material)\n\t\tthis.selectedCircleMesh.rotation.x = -Math.PI / 2\n\t\tthis.selectedCircleMesh.position.y = 0\n\t\tthis.selectedCircleMesh.visible = false\n\n\t\tthis.textContainer = document.createElement('div')\n\t\tthis.textContainer.className = 'text-label'\n\t\tthis.textContainer.style.marginTop = '-1em'\n\t\tconst textLabel = new CSS2DObject(this.textContainer)\n\t\ttextLabel.position.set(0, 13, 0)\n\n\t\tconst newGroup = new Group()\n\t\tnewGroup.add(textLabel)\n\t\tnewGroup.add(this.selectedCircleMesh)\n\t\tnewGroup.add(model.clone())\n\t\tnewGroup.userData = {\n\t\t\tgameObjectKey: key\n\t\t}\n\t\tthis.model = newGroup\n\t}\n\n\tprivate circle = (show: boolean, event: 'highlighted' | 'selected'): void => {\n\t\tconst circle = this.selectedCircleMesh\n\t\tconst color = circle.material.color.getHex()\n\t\tlet targetColor = color\n\n\t\tif (event === 'highlighted') {\n\t\t\ttargetColor = 0x333333\n\t\t} else if (event === 'selected') {\n\t\t\ttargetColor = 0x336699\n\t\t}\n\t\tif (circle.visible !== show || targetColor !== color) {\n\t\t\tcircle.visible = show\n\t\t\tcircle.material.color.setHex(targetColor)\n\t\t}\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tpublic update(time: number, delta: number): void {\n\t\tif (!this.worldData.isAnyDirty) {\n\t\t\treturn\n\t\t}\n\t\tconst { position, selected, rotation, highlighted, isDirty, clearDirty } = this.worldData\n\t\tif (isDirty.position) {\n\t\t\tthis.model.position.x = position.x\n\t\t\tthis.model.position.y = position.y\n\t\t\tthis.model.position.z = position.z\n\t\t}\n\t\tif (isDirty.rotation) {\n\t\t\tthis.model.rotation.x = rotation.x\n\t\t\tthis.model.rotation.y = rotation.y\n\t\t\tthis.model.rotation.z = rotation.z\n\t\t}\n\t\tif (isDirty.selected || isDirty.highlighted) {\n\t\t\tthis.circle(selected, 'selected')\n\t\t\tif (!selected) {\n\t\t\t\tthis.circle(highlighted, 'highlighted')\n\t\t\t}\n\t\t}\n\t\tif (this.lastTextUpdate + 100 <= time || this.lastTextUpdate === 0) {\n\t\t\tconst { x, z } = position\n\t\t\tconst timeStr = Math.round(time).toString()\n\t\t\tlet xStr = x.toFixed(2).toString()\n\t\t\tlet zStr = z.toFixed(2).toString()\n\t\t\tif (x > 0) {\n\t\t\t\txStr = `&nbsp;${xStr}`\n\t\t\t}\n\t\t\tif (z > 0) {\n\t\t\t\tzStr = `&nbsp;${zStr}`\n\t\t\t}\n\t\t\tthis.textContainer.innerHTML = `x: ${xStr} <br />z: ${zStr}<br />update: ${timeStr}<br />`\n\t\t\tthis.lastTextUpdate = time\n\t\t}\n\t\tclearDirty()\n\t}\n}\nexport default GameObject\n","/* eslint-disable no-console */\ntype LoggerType = (prefix?: string, loglevel?: LogLevel, maxLogsPerSecond?: number) => LogType\ntype LogType = (message?: unknown, ...optionalParams: unknown[]) => void\n\ntype LogLevel = 'info' | 'warn' | 'error'\n\nconst logger: LoggerType = (prefix = '', loglevel: LogLevel = 'info', maxLogsPerSecond = 10): LogType => {\n\tlet logCount = 0\n\tlet lastLog = new Date().getTime()\n\tconst log: LogType = (message, ...optionalParams): void => {\n\t\tif (process.env.NODE_ENV === 'production') {\n\t\t\treturn\n\t\t}\n\t\tconst now = new Date().getTime()\n\t\tif (lastLog - now >= 1000 / maxLogsPerSecond) {\n\t\t\tlogCount = 0\n\t\t\tlog(message, ...optionalParams)\n\t\t}\n\t\tif (logCount <= maxLogsPerSecond) {\n\t\t\tif (loglevel === 'info') console.info(`${prefix}${message}`, ...optionalParams)\n\t\t\tif (loglevel === 'warn') console.warn(`${prefix}${message}`, ...optionalParams)\n\t\t\tif (loglevel === 'error') console.error(`${prefix}${message}`, ...optionalParams)\n\t\t\tlogCount += 1\n\t\t\tlastLog = now\n\t\t}\n\t}\n\treturn log\n}\n\nexport default logger\n","import { ConnectResponse, CreateUnitRequest, CreateUnitResponse, GameState, SetUnitPosition, SetUnitDestination } from './models'\nimport logger from '../../infrastructure/logger'\n\ninterface WebsocketMessages {\n\tCreateUnit: CreateUnitResponse\n\tSetUnitPosition: SetUnitPosition\n\tSetUnitDestination: SetUnitDestination\n}\n\ntype WebsocketMessageType = keyof WebsocketMessages\ntype WebsocketMessage = WebsocketMessages[WebsocketMessageType]\n\ntype MessageHandlerCallback<TMessage> = (message: TMessage) => void\ntype AddMessageHandler = <TMessageKey extends WebsocketMessageType>(type: TMessageKey, handler: MessageHandlerCallback<WebsocketMessages[TMessageKey]>) => void\ninterface MessageHandler {\n\ttype: WebsocketMessageType\n\t// eslint-disable-next-line @typescript-eslint/no-explicit-any\n\thandler: MessageHandlerCallback<any & WebsocketMessage>\n}\nconst log = logger('server_')\nclass GameStateDataService {\n\tprivate apiUri: string\n\n\tprivate wsUri: string\n\n\tprivate socket: WebSocket | undefined\n\n\tprivate messageHandlers: MessageHandler[]\n\n\tconstructor() {\n\t\tthis.apiUri = process.env.REACT_APP_SERVER_API\n\t\tthis.wsUri = process.env.REACT_APP_SERVER_WS\n\n\t\tthis.messageHandlers = []\n\t}\n\n\tpublic connectToWebsocket = (userId: number): Promise<boolean> =>\n\t\tnew Promise<boolean>((resolve, reject) => {\n\t\t\tfetch(`${this.apiUri}/register`, {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tmode: 'cors',\n\t\t\t\theaders: {\n\t\t\t\t\tAccept: 'application/json',\n\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({ user_id: userId })\n\t\t\t})\n\t\t\t\t.then((r) => {\n\t\t\t\t\treturn r.json()\n\t\t\t\t})\n\t\t\t\t.then((r: ConnectResponse): string => {\n\t\t\t\t\treturn r.url\n\t\t\t\t})\n\t\t\t\t.then((url) => {\n\t\t\t\t\tconst socket = new WebSocket(`${this.wsUri}/${url}`)\n\t\t\t\t\tsocket.onopen = () => {\n\t\t\t\t\t\tsocket.onmessage = this.onMessageRecived\n\t\t\t\t\t\tthis.socket = socket\n\t\t\t\t\t\tresolve(true)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(() => reject())\n\t\t})\n\n\tpublic createUnit = (x: number, z: number): void => {\n\t\tthis.socket?.send(JSON.stringify({ CreateUnit: { position: [x, z] } } as CreateUnitRequest))\n\t}\n\n\tpublic setUnitPosition = (id: string, x: number, z: number): void => {\n\t\tthis.socket?.send(JSON.stringify({ SetUnitPosition: { position: [x, z], id } } as SetUnitPosition))\n\t}\n\n\tpublic setUnitDestination = (id: string, x: number, z: number): void => {\n\t\tthis.socket?.send(JSON.stringify({ SetUnitDestination: { destination: [x, z], id } } as SetUnitDestination))\n\t}\n\n\tpublic fetchInitialGameState = (): Promise<GameState> =>\n\t\tnew Promise<GameState>((resolve, reject) => {\n\t\t\tfetch(`${this.apiUri}/game`)\n\t\t\t\t.then((response) => response.json())\n\t\t\t\t.then((state: GameState) => resolve(state))\n\t\t\t\t.catch(() => reject())\n\t\t})\n\n\tpublic addMessageHandler: AddMessageHandler = (type, handler) => {\n\t\tthis.messageHandlers = [...this.messageHandlers, { type, handler }]\n\t}\n\n\tprivate notifyHandlers = (type: WebsocketMessageType, message: WebsocketMessage): void => {\n\t\tthis.messageHandlers.filter((h) => h.type === type).forEach((handler) => handler.handler(message))\n\t}\n\n\tprivate onMessageRecived = (e: MessageEvent): void => {\n\t\tconst msg: WebsocketMessage = JSON.parse(e.data)\n\t\t// eslint-disable-next-line no-console\n\t\tlog('message', msg)\n\t\tif ((msg as CreateUnitResponse).CreateUnit) {\n\t\t\tthis.notifyHandlers('CreateUnit', msg)\n\t\t}\n\t\tif ((msg as SetUnitDestination).SetUnitDestination) {\n\t\t\tthis.notifyHandlers('SetUnitDestination', msg)\n\t\t}\n\t\tif ((msg as SetUnitPosition).SetUnitPosition) {\n\t\t\tthis.notifyHandlers('SetUnitPosition', msg)\n\t\t}\n\t}\n}\n\nexport default GameStateDataService\n","import { Intersection, Object3D, Raycaster, Scene } from 'three'\nimport { IGameObject } from './gameObjects/gameObject'\nimport { ICordinates, IGameObjectWorldData } from './gameObjects/gameObjectWorldData'\nimport { IUpdate } from './gameRenderer'\nimport WorldEnviroment, { WorldEnviromentDebugEnum } from './worldEnviroment'\nimport CompareHelper from '../infrastructure/compareHelper'\n\nclass GameWorld implements IUpdate {\n\tprivate setGameObjectWorldDataListeners: {\n\t\ttype: keyof IGameObjectWorldData\n\t\thandler: (id: string, data: IGameObjectWorldData) => void\n\t}[]\n\n\tprivate scene: Scene\n\n\tpublic gameObjects: IGameObject[]\n\n\tprivate worldEnviroment: WorldEnviroment\n\n\tconstructor(scene: Scene) {\n\t\tthis.setGameObjectWorldDataListeners = []\n\t\tthis.scene = scene\n\t\tthis.worldEnviroment = new WorldEnviroment(scene)\n\t\tthis.gameObjects = []\n\t}\n\n\tpublic initialize = (): void => {\n\t\tthis.worldEnviroment.setDebug(WorldEnviromentDebugEnum.ShowMediumGrid, WorldEnviromentDebugEnum.ShowLargeGrid)\n\t\tthis.worldEnviroment.initialize()\n\t}\n\n\tpublic update = (time: number, delta: number): void => {\n\t\tthis.gameObjects.forEach((gm) => gm.update(time, delta))\n\t}\n\n\tpublic addGameObject = (gameObject: IGameObject): void => {\n\t\tthis.scene.add(gameObject.model)\n\t\tthis.gameObjects = [...this.gameObjects, gameObject]\n\t}\n\n\tpublic addSetGameObjectWorldDataListener = (prop: keyof IGameObjectWorldData, handler: (id: string, data: IGameObjectWorldData) => void): void => {\n\t\tthis.setGameObjectWorldDataListeners = [...this.setGameObjectWorldDataListeners, { type: prop, handler }]\n\t}\n\n\tprivate notifySetGameObjectWorldDataListener = <K extends keyof IGameObjectWorldData>(id: string, prop: K, data: IGameObjectWorldData): void => {\n\t\tthis.setGameObjectWorldDataListeners\n\t\t\t.filter((li) => li.type === prop)\n\t\t\t.forEach((li) => {\n\t\t\t\tli.handler(id, data)\n\t\t\t})\n\t}\n\n\tpublic setGameObjectWorldData = <K extends keyof IGameObjectWorldData>(id: string, prop: K, value: IGameObjectWorldData[K]): void => {\n\t\tthis.gameObjects\n\t\t\t.filter((x) => x.key === id)\n\t\t\t.forEach((g) => {\n\t\t\t\tconst gameObject = g\n\t\t\t\tconst changed = !CompareHelper.shallowEqual(gameObject.worldData[prop], value)\n\t\t\t\tif (changed) {\n\t\t\t\t\tgameObject.worldData[prop] = value\n\t\t\t\t\tthis.notifySetGameObjectWorldDataListener(id, prop, gameObject.worldData)\n\t\t\t\t}\n\t\t\t})\n\t}\n\n\tpublic setSelectedGameObjectsWorldData = <K extends keyof IGameObjectWorldData>(prop: K, value: IGameObjectWorldData[K]): void => {\n\t\tthis.forEachSelectedGameObject((go) => {\n\t\t\tthis.setGameObjectWorldData(go.key, prop, value)\n\t\t})\n\t}\n\n\tprivate forEachSelectedGameObject = (callback: (gameObject: IGameObject, index: number, all: IGameObject[]) => void): void => {\n\t\tthis.gameObjects.filter((x) => x.worldData.selected).forEach(callback)\n\t}\n\n\tpublic setSelectedGameObjectsDestination = (destination: ICordinates): void => {\n\t\tthis.forEachSelectedGameObject((go) => {\n\t\t\tthis.setGameObjectWorldData(go.key, 'destination', {\n\t\t\t\t...go.worldData.destination,\n\t\t\t\tx: destination.x,\n\t\t\t\tz: destination.z\n\t\t\t})\n\t\t})\n\t}\n\n\tpublic getSceneIntersection = (raycaster: Raycaster): Intersection[] => {\n\t\treturn raycaster.intersectObject(this.scene, true)\n\t}\n\n\tpublic getGameObjectIntersection = (raycaster: Raycaster): IGameObject | null => {\n\t\tconst intersects = raycaster.intersectObjects(\n\t\t\tthis.gameObjects.map((go) => go.model),\n\t\t\ttrue\n\t\t)\n\t\tlet intersectedModel: IGameObject | null = null\n\t\tintersects.forEach((intersection): void => {\n\t\t\tconst gameModel = this.getGameObjectRoot(intersection.object)\n\t\t\tif (!intersectedModel && gameModel) {\n\t\t\t\tintersectedModel = gameModel\n\t\t\t}\n\t\t})\n\n\t\treturn intersectedModel\n\t}\n\n\tpublic hoverGameObject = (gameObject: IGameObject | null = null): void => {\n\t\tconst go = this.gameObjects.find((x) => x.worldData.highlighted || (gameObject !== null && x.key === gameObject.key))\n\t\tif (go) {\n\t\t\tconst { worldData } = go\n\t\t\tif (gameObject !== null && go.key === gameObject.key) {\n\t\t\t\tworldData.highlighted = true\n\t\t\t} else {\n\t\t\t\tworldData.highlighted = false\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic selectGameObject = (gameObject: IGameObject | null = null, removeExsistingSelection: boolean): void => {\n\t\tthis.gameObjects\n\t\t\t.filter((x) => x.worldData.selected || (gameObject !== null && x.key === gameObject.key))\n\t\t\t.forEach((go) => {\n\t\t\t\tconst { worldData } = go\n\t\t\t\tif (gameObject !== null && go.key === gameObject.key) {\n\t\t\t\t\tworldData.selected = true\n\t\t\t\t} else if (removeExsistingSelection) {\n\t\t\t\t\tworldData.selected = false\n\t\t\t\t}\n\t\t\t})\n\t}\n\n\tprivate getGameObjectByKey = (key: string): IGameObject | null => {\n\t\tconst objects = this.gameObjects.filter((gm) => gm.key === key)\n\t\tif (objects.length > 0) return objects[0]\n\t\treturn null\n\t}\n\n\tprivate getGameObjectRoot = (object: Object3D): IGameObject | null => {\n\t\tif (object.userData.gameObjectKey) {\n\t\t\treturn this.getGameObjectByKey(object.userData.gameObjectKey)\n\t\t}\n\t\tif (object.parent) {\n\t\t\treturn this.getGameObjectRoot(object.parent)\n\t\t}\n\t\treturn null\n\t}\n}\n\nexport default GameWorld\n","import Stats from 'three/examples/jsm/libs/stats.module'\nimport { Clock, PerspectiveCamera, Scene, sRGBEncoding, WebGLRenderer } from 'three'\n\nimport { CSS2DRenderer } from 'three/examples/jsm/renderers/CSS2DRenderer.js'\n\nexport interface IUpdate {\n\tupdate: (timer: number, delta: number) => void\n}\nclass GameRenderer {\n\tprivate camera: PerspectiveCamera\n\n\tprivate scene: Scene\n\n\tprivate container: HTMLElement\n\n\tprivate renderer: WebGLRenderer\n\n\tprivate labelRenderer: CSS2DRenderer\n\n\tprivate clock: Clock\n\n\tprivate stats: Stats\n\n\tprivate fps = 200\n\n\tprivate lastRender = Date.now()\n\n\tprivate updateTargets: IUpdate[]\n\n\tconstructor(container: HTMLElement, scene: Scene, camera: PerspectiveCamera) {\n\t\tthis.container = container\n\t\tthis.scene = scene\n\t\tthis.camera = camera\n\t\tthis.renderer = new WebGLRenderer({ antialias: true })\n\t\tthis.clock = new Clock()\n\t\tthis.updateTargets = []\n\t\tthis.labelRenderer = new CSS2DRenderer()\n\t\tthis.stats = Stats()\n\t}\n\n\tpublic initialize = (): void => {\n\t\t// init rendere\n\n\t\tthis.renderer.setPixelRatio(window.devicePixelRatio)\n\t\tthis.renderer.setSize(window.innerWidth, window.innerHeight)\n\n\t\tthis.renderer.outputEncoding = sRGBEncoding\n\t\tthis.renderer.shadowMap.enabled = true\n\t\t// this.renderer.toneMapping = ACESFilmicToneMapping\n\t\t// this.renderer.toneMappingExposure = 0.85\n\n\t\tthis.labelRenderer.setSize(window.innerWidth, window.innerHeight)\n\t\tthis.labelRenderer.domElement.style.position = 'absolute'\n\t\tthis.labelRenderer.domElement.style.top = '0px'\n\n\t\twindow.addEventListener('resize', this.handleWindowResize)\n\t\tthis.container.appendChild(this.renderer.domElement)\n\t\tthis.container.appendChild(this.labelRenderer.domElement)\n\t\tthis.container.appendChild(this.stats.dom)\n\t}\n\n\tprivate handleWindowResize = (/* event: UIEvent */): void => {\n\t\tthis.camera.aspect = window.innerWidth / window.innerHeight\n\t\tthis.camera.updateProjectionMatrix()\n\t\tthis.renderer.setSize(window.innerWidth, window.innerHeight)\n\t\tthis.labelRenderer.setSize(window.innerWidth, window.innerHeight)\n\t}\n\n\tpublic addUpdateTarget = (updateTarget: IUpdate): void => {\n\t\tthis.updateTargets = [...this.updateTargets, updateTarget]\n\t}\n\n\tpublic start = (): void => {\n\t\trequestAnimationFrame(this.renderLoop)\n\t}\n\n\tprivate renderLoop = (time: number): void => {\n\t\tconst now = Date.now()\n\t\tconst lastRenderDiff = now - this.lastRender\n\t\tconst interval = 1000 / this.fps\n\t\tif (lastRenderDiff > interval) {\n\t\t\tconst delta = this.clock.getDelta()\n\t\t\t// this.gameWorld.update(time, delta)\n\t\t\tthis.updateTargets.forEach((updateTarget) => updateTarget.update(time, delta))\n\t\t\tthis.stats.update()\n\t\t\tthis.lastRender = now - (lastRenderDiff % interval)\n\t\t\tthis.renderer.render(this.scene, this.camera)\n\t\t\tthis.labelRenderer.render(this.scene, this.camera)\n\t\t}\n\t\trequestAnimationFrame(this.renderLoop)\n\t}\n}\nexport default GameRenderer\n","/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable @typescript-eslint/no-this-alias */\n/* eslint-disable no-restricted-properties */\n/* eslint-disable @typescript-eslint/no-shadow */\nimport { EventDispatcher, Matrix4, MOUSE, PerspectiveCamera, Quaternion, Spherical, TOUCH, Vector2, Vector3 } from 'three'\nimport logger from '../../infrastructure/logger'\n\nconst changeEvent = { type: 'change' }\nconst startEvent = { type: 'start' }\nconst endEvent = { type: 'end' }\n\nconst warn = logger('camControls_', 'warn')\n\nclass CameraOrbitControls extends EventDispatcher {\n\tcamera: PerspectiveCamera\n\n\tdomElement: HTMLElement\n\n\tenabled: boolean\n\n\ttarget: Vector3\n\n\tminDistance: number\n\n\tmaxDistance: number\n\n\tminZoom: number\n\n\tmaxZoom: number\n\n\tminPolarAngle: number\n\n\tmaxPolarAngle: number\n\n\tminAzimuthAngle: number\n\n\tmaxAzimuthAngle: number\n\n\tenableDamping: boolean\n\n\tdampingFactor: number\n\n\tenableZoom: boolean\n\n\tzoomSpeed: number\n\n\tenableRotate: boolean\n\n\trotateSpeed: number\n\n\tenablePan: boolean\n\n\tpanSpeed: number\n\n\tscreenSpacePanning: boolean\n\n\tkeyPanSpeed: number\n\n\tautoRotate: boolean\n\n\tautoRotateSpeed: number\n\n\tkeys: { LEFT: string; UP: string; RIGHT: string; BOTTOM: string }\n\n\tmouseButtons: { LEFT: MOUSE; MIDDLE: MOUSE; RIGHT: MOUSE }\n\n\ttouches: { ONE: TOUCH; TWO: TOUCH }\n\n\ttarget0: Vector3\n\n\tposition0: Vector3\n\n\tzoom0: number\n\n\tdomElementKeyEvents: HTMLElement | null\n\n\tgetPolarAngle: () => number\n\n\tgetAzimuthalAngle: () => number\n\n\tlistenToKeyEvents: (domElement: HTMLElement) => void\n\n\tsaveState: () => void\n\n\treset: () => void\n\n\tdispose: () => void\n\n\tupdate = (): boolean => true\n\n\tconstructor(camera: PerspectiveCamera, domElement: HTMLElement) {\n\t\tsuper()\n\n\t\tif (domElement === undefined) warn('THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.')\n\n\t\tthis.camera = camera\n\t\tthis.domElement = domElement\n\n\t\t// Set to false to disable this control\n\t\tthis.enabled = true\n\n\t\t// \"target\" sets the location of focus, where the object orbits around\n\t\tthis.target = new Vector3()\n\n\t\t// How far you can dolly in and out ( PerspectiveCamera only )\n\t\tthis.minDistance = 0\n\t\tthis.maxDistance = Infinity\n\n\t\t// How far you can zoom in and out ( OrthographicCamera only )\n\t\tthis.minZoom = 0\n\t\tthis.maxZoom = Infinity\n\n\t\t// How far you can orbit vertically, upper and lower limits.\n\t\t// Range is 0 to Math.PI radians.\n\t\tthis.minPolarAngle = 0 // radians\n\t\tthis.maxPolarAngle = Math.PI // radians\n\n\t\t// How far you can orbit horizontally, upper and lower limits.\n\t\t// If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\n\t\tthis.minAzimuthAngle = -Infinity // radians\n\t\tthis.maxAzimuthAngle = Infinity // radians\n\n\t\t// Set to true to enable damping (inertia)\n\t\t// If damping is enabled, you must call controls.update() in your animation loop\n\t\tthis.enableDamping = false\n\t\tthis.dampingFactor = 0.05\n\n\t\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t\t// Set to false to disable zooming\n\t\tthis.enableZoom = true\n\t\tthis.zoomSpeed = 1.0\n\n\t\t// Set to false to disable rotating\n\t\tthis.enableRotate = true\n\t\tthis.rotateSpeed = 1.0\n\n\t\t// Set to false to disable panning\n\t\tthis.enablePan = true\n\t\tthis.panSpeed = 1.0\n\t\tthis.screenSpacePanning = true // if false, pan orthogonal to world-space direction camera.up\n\t\tthis.keyPanSpeed = 7.0 // pixels moved per arrow key push\n\n\t\t// Set to true to automatically rotate around the target\n\t\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\t\tthis.autoRotate = false\n\t\tthis.autoRotateSpeed = 2.0 // 30 seconds per orbit when fps is 60\n\n\t\t// The four arrow keys\n\t\tthis.keys = {\n\t\t\tLEFT: 'ArrowLeft',\n\t\t\tUP: 'ArrowUp',\n\t\t\tRIGHT: 'ArrowRight',\n\t\t\tBOTTOM: 'ArrowDown'\n\t\t}\n\n\t\t// Mouse buttons\n\t\tthis.mouseButtons = {\n\t\t\tLEFT: MOUSE.ROTATE,\n\t\t\tMIDDLE: MOUSE.DOLLY,\n\t\t\tRIGHT: MOUSE.PAN\n\t\t}\n\n\t\t// Touch fingers\n\t\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN }\n\n\t\t// for reset\n\t\tthis.target0 = this.target.clone()\n\t\tthis.position0 = this.camera.position.clone()\n\t\tthis.zoom0 = this.camera.zoom\n\n\t\t// the target DOM element for key events\n\t\tthis.domElementKeyEvents = null\n\n\t\t//\n\t\t// public methods\n\t\t//\n\n\t\tthis.getPolarAngle = (): number => {\n\t\t\treturn spherical.phi\n\t\t}\n\n\t\tthis.getAzimuthalAngle = (): number => {\n\t\t\treturn spherical.theta\n\t\t}\n\n\t\tthis.listenToKeyEvents = (domElement: HTMLElement) => {\n\t\t\tdomElement.addEventListener('keydown', onKeyDown)\n\t\t\tthis.domElementKeyEvents = domElement\n\t\t}\n\n\t\tthis.saveState = (): void => {\n\t\t\tscope.target0.copy(scope.target)\n\t\t\tscope.position0.copy(scope.camera.position)\n\t\t\tscope.zoom0 = scope.camera.zoom\n\t\t}\n\n\t\tthis.reset = (): void => {\n\t\t\tscope.target.copy(scope.target0)\n\t\t\tscope.camera.position.copy(scope.position0)\n\t\t\tscope.camera.zoom = scope.zoom0\n\n\t\t\tscope.camera.updateProjectionMatrix()\n\t\t\tscope.dispatchEvent(changeEvent)\n\n\t\t\tscope.update()\n\n\t\t\tstate = STATE.NONE\n\t\t}\n\n\t\t// this method is exposed, but perhaps it would be better if we can make it private...\n\t\tthis.update = ((): (() => boolean) => {\n\t\t\tconst offset = new Vector3()\n\n\t\t\t// so camera.up is the orbit axis\n\t\t\tconst quat = new Quaternion().setFromUnitVectors(camera.up, new Vector3(0, 1, 0))\n\t\t\tconst quatInverse = quat.clone().invert()\n\n\t\t\tconst lastPosition = new Vector3()\n\t\t\tconst lastQuaternion = new Quaternion()\n\n\t\t\tconst twoPI = 2 * Math.PI\n\n\t\t\treturn (): boolean => {\n\t\t\t\tconst { position } = scope.camera\n\n\t\t\t\toffset.copy(position).sub(scope.target)\n\n\t\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\t\toffset.applyQuaternion(quat)\n\n\t\t\t\t// angle from z-axis around y-axis\n\t\t\t\tspherical.setFromVector3(offset)\n\n\t\t\t\tif (scope.autoRotate && state === STATE.NONE) {\n\t\t\t\t\trotateLeft(getAutoRotationAngle())\n\t\t\t\t}\n\n\t\t\t\tif (scope.enableDamping) {\n\t\t\t\t\tspherical.theta += sphericalDelta.theta * scope.dampingFactor\n\t\t\t\t\tspherical.phi += sphericalDelta.phi * scope.dampingFactor\n\t\t\t\t} else {\n\t\t\t\t\tspherical.theta += sphericalDelta.theta\n\t\t\t\t\tspherical.phi += sphericalDelta.phi\n\t\t\t\t}\n\n\t\t\t\t// restrict theta to be between desired limits\n\n\t\t\t\tlet min = scope.minAzimuthAngle\n\t\t\t\tlet max = scope.maxAzimuthAngle\n\n\t\t\t\tif (Number.isFinite(min) && Number.isFinite(max)) {\n\t\t\t\t\tif (min < -Math.PI) min += twoPI\n\t\t\t\t\telse if (min > Math.PI) min -= twoPI\n\n\t\t\t\t\tif (max < -Math.PI) max += twoPI\n\t\t\t\t\telse if (max > Math.PI) max -= twoPI\n\n\t\t\t\t\tif (min <= max) {\n\t\t\t\t\t\tspherical.theta = Math.max(min, Math.min(max, spherical.theta))\n\t\t\t\t\t} else {\n\t\t\t\t\t\tspherical.theta = spherical.theta > (min + max) / 2 ? Math.max(min, spherical.theta) : Math.min(max, spherical.theta)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// restrict phi to be between desired limits\n\t\t\t\tspherical.phi = Math.max(scope.minPolarAngle, Math.min(scope.maxPolarAngle, spherical.phi))\n\n\t\t\t\tspherical.makeSafe()\n\n\t\t\t\tspherical.radius *= scale\n\n\t\t\t\t// restrict radius to be between desired limits\n\t\t\t\tspherical.radius = Math.max(scope.minDistance, Math.min(scope.maxDistance, spherical.radius))\n\n\t\t\t\t// move target to panned location\n\n\t\t\t\tif (scope.enableDamping === true) {\n\t\t\t\t\tscope.target.addScaledVector(panOffset, scope.dampingFactor)\n\t\t\t\t} else {\n\t\t\t\t\tscope.target.add(panOffset)\n\t\t\t\t}\n\n\t\t\t\toffset.setFromSpherical(spherical)\n\n\t\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\t\toffset.applyQuaternion(quatInverse)\n\n\t\t\t\tposition.copy(scope.target).add(offset)\n\n\t\t\t\tscope.camera.lookAt(scope.target)\n\n\t\t\t\tif (scope.enableDamping === true) {\n\t\t\t\t\tsphericalDelta.theta *= 1 - scope.dampingFactor\n\t\t\t\t\tsphericalDelta.phi *= 1 - scope.dampingFactor\n\n\t\t\t\t\tpanOffset.multiplyScalar(1 - scope.dampingFactor)\n\t\t\t\t} else {\n\t\t\t\t\tsphericalDelta.set(0, 0, 0)\n\n\t\t\t\t\tpanOffset.set(0, 0, 0)\n\t\t\t\t}\n\n\t\t\t\tscale = 1\n\n\t\t\t\t// update condition is:\n\t\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\t\tif (zoomChanged || lastPosition.distanceToSquared(scope.camera.position) > EPS || 8 * (1 - lastQuaternion.dot(scope.camera.quaternion)) > EPS) {\n\t\t\t\t\tscope.dispatchEvent(changeEvent)\n\n\t\t\t\t\tlastPosition.copy(scope.camera.position)\n\t\t\t\t\tlastQuaternion.copy(scope.camera.quaternion)\n\t\t\t\t\tzoomChanged = false\n\n\t\t\t\t\treturn true\n\t\t\t\t}\n\n\t\t\t\treturn false\n\t\t\t}\n\t\t})()\n\n\t\tthis.dispose = (): void => {\n\t\t\tscope.domElement.removeEventListener('contextmenu', onContextMenu)\n\n\t\t\tscope.domElement.removeEventListener('pointerdown', onPointerDown)\n\t\t\tscope.domElement.removeEventListener('wheel', onMouseWheel)\n\n\t\t\tscope.domElement.removeEventListener('touchstart', onTouchStart)\n\t\t\tscope.domElement.removeEventListener('touchend', onTouchEnd)\n\t\t\tscope.domElement.removeEventListener('touchmove', onTouchMove)\n\n\t\t\tscope.domElement.ownerDocument.removeEventListener('pointermove', onPointerMove)\n\t\t\tscope.domElement.ownerDocument.removeEventListener('pointerup', onPointerUp)\n\n\t\t\tif (scope.domElementKeyEvents !== null) {\n\t\t\t\tscope.domElementKeyEvents.removeEventListener('keydown', onKeyDown)\n\t\t\t}\n\n\t\t\t// scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\t\t}\n\n\t\t//\n\t\t// internals\n\t\t//\n\n\t\tconst scope = this\n\n\t\tconst STATE = {\n\t\t\tNONE: -1,\n\t\t\tROTATE: 0,\n\t\t\tDOLLY: 1,\n\t\t\tPAN: 2,\n\t\t\tTOUCH_ROTATE: 3,\n\t\t\tTOUCH_PAN: 4,\n\t\t\tTOUCH_DOLLY_PAN: 5,\n\t\t\tTOUCH_DOLLY_ROTATE: 6\n\t\t}\n\n\t\tlet state = STATE.NONE\n\n\t\tconst EPS = 0.000001\n\n\t\t// current position in spherical coordinates\n\t\tconst spherical = new Spherical()\n\t\tconst sphericalDelta = new Spherical()\n\n\t\tlet scale = 1\n\t\tconst panOffset = new Vector3()\n\t\tlet zoomChanged = false\n\n\t\tconst rotateStart = new Vector2()\n\t\tconst rotateEnd = new Vector2()\n\t\tconst rotateDelta = new Vector2()\n\n\t\tconst panStart = new Vector2()\n\t\tconst panEnd = new Vector2()\n\t\tconst panDelta = new Vector2()\n\n\t\tconst dollyStart = new Vector2()\n\t\tconst dollyEnd = new Vector2()\n\t\tconst dollyDelta = new Vector2()\n\n\t\tfunction getAutoRotationAngle(): number {\n\t\t\treturn ((2 * Math.PI) / 60 / 60) * scope.autoRotateSpeed\n\t\t}\n\n\t\tfunction getZoomScale(): number {\n\t\t\treturn Math.pow(0.95, scope.zoomSpeed)\n\t\t}\n\n\t\tfunction rotateLeft(angle: number): void {\n\t\t\tsphericalDelta.theta -= angle\n\t\t}\n\n\t\tfunction rotateUp(angle: number): void {\n\t\t\tsphericalDelta.phi -= angle\n\t\t}\n\n\t\tconst panLeft = (() => {\n\t\t\tconst v = new Vector3()\n\n\t\t\treturn function panLeft(distance: number, objectMatrix: Matrix4) {\n\t\t\t\tv.setFromMatrixColumn(objectMatrix, 0) // get X column of objectMatrix\n\t\t\t\tv.multiplyScalar(-distance)\n\n\t\t\t\tpanOffset.add(v)\n\t\t\t}\n\t\t})()\n\n\t\tconst panUp = (() => {\n\t\t\tconst v = new Vector3()\n\n\t\t\treturn function panUp(distance: number, objectMatrix: Matrix4) {\n\t\t\t\tif (scope.screenSpacePanning === true) {\n\t\t\t\t\tv.setFromMatrixColumn(objectMatrix, 1)\n\t\t\t\t} else {\n\t\t\t\t\tv.setFromMatrixColumn(objectMatrix, 0)\n\t\t\t\t\tv.crossVectors(scope.camera.up, v)\n\t\t\t\t}\n\n\t\t\t\tv.multiplyScalar(distance)\n\n\t\t\t\tpanOffset.add(v)\n\t\t\t}\n\t\t})()\n\n\t\t// deltaX and deltaY are in pixels; right and down are positive\n\t\tconst pan = (() => {\n\t\t\tconst offset = new Vector3()\n\n\t\t\treturn function pan(deltaX: number, deltaY: number) {\n\t\t\t\tconst element = scope.domElement\n\n\t\t\t\tif (scope.camera.isPerspectiveCamera) {\n\t\t\t\t\t// perspective\n\t\t\t\t\tconst { position } = scope.camera\n\t\t\t\t\toffset.copy(position).sub(scope.target)\n\t\t\t\t\tlet targetDistance = offset.length()\n\n\t\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\t\ttargetDistance *= Math.tan(((scope.camera.fov / 2) * Math.PI) / 180.0)\n\n\t\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\t\tpanLeft((2 * deltaX * targetDistance) / element.clientHeight, scope.camera.matrix)\n\t\t\t\t\tpanUp((2 * deltaY * targetDistance) / element.clientHeight, scope.camera.matrix)\n\t\t\t\t} else {\n\t\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\t\twarn('WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.')\n\t\t\t\t\tscope.enablePan = false\n\t\t\t\t}\n\t\t\t}\n\t\t})()\n\n\t\tfunction dollyOut(dollyScale: number): void {\n\t\t\tif (scope.camera.isPerspectiveCamera) {\n\t\t\t\tscale /= dollyScale\n\t\t\t} else {\n\t\t\t\twarn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.')\n\t\t\t\tscope.enableZoom = false\n\t\t\t}\n\t\t}\n\n\t\tfunction dollyIn(dollyScale: number): void {\n\t\t\tif (scope.camera.isPerspectiveCamera) {\n\t\t\t\tscale *= dollyScale\n\t\t\t} else {\n\t\t\t\twarn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.')\n\t\t\t\tscope.enableZoom = false\n\t\t\t}\n\t\t}\n\n\t\tfunction handleMouseDownRotate(event: { clientX: number; clientY: number }): void {\n\t\t\trotateStart.set(event.clientX, event.clientY)\n\t\t}\n\n\t\tfunction handleMouseDownDolly(event: { clientX: number; clientY: number }): void {\n\t\t\tdollyStart.set(event.clientX, event.clientY)\n\t\t}\n\n\t\tfunction handleMouseDownPan(event: { clientX: number; clientY: number }): void {\n\t\t\tpanStart.set(event.clientX, event.clientY)\n\t\t}\n\n\t\tfunction handleMouseMoveRotate(event: { clientX: number; clientY: number }): void {\n\t\t\trotateEnd.set(event.clientX, event.clientY)\n\n\t\t\trotateDelta.subVectors(rotateEnd, rotateStart).multiplyScalar(scope.rotateSpeed)\n\n\t\t\tconst element = scope.domElement\n\n\t\t\trotateLeft((2 * Math.PI * rotateDelta.x) / element.clientHeight) // yes, height\n\n\t\t\trotateUp((2 * Math.PI * rotateDelta.y) / element.clientHeight)\n\n\t\t\trotateStart.copy(rotateEnd)\n\n\t\t\tscope.update()\n\t\t}\n\n\t\tfunction handleMouseMoveDolly(event: { clientX: number; clientY: number }): void {\n\t\t\tdollyEnd.set(event.clientX, event.clientY)\n\n\t\t\tdollyDelta.subVectors(dollyEnd, dollyStart)\n\n\t\t\tif (dollyDelta.y > 0) {\n\t\t\t\tdollyOut(getZoomScale())\n\t\t\t} else if (dollyDelta.y < 0) {\n\t\t\t\tdollyIn(getZoomScale())\n\t\t\t}\n\n\t\t\tdollyStart.copy(dollyEnd)\n\n\t\t\tscope.update()\n\t\t}\n\n\t\tfunction handleMouseMovePan(event: { clientX: number; clientY: number }): void {\n\t\t\tpanEnd.set(event.clientX, event.clientY)\n\n\t\t\tpanDelta.subVectors(panEnd, panStart).multiplyScalar(scope.panSpeed)\n\n\t\t\tpan(panDelta.x, panDelta.y)\n\n\t\t\tpanStart.copy(panEnd)\n\n\t\t\tscope.update()\n\t\t}\n\n\t\tfunction handleMouseUp(event: MouseEvent): void {\n\t\t\t// no-op\n\t\t}\n\n\t\tfunction handleMouseWheel(event: { deltaY: number }): void {\n\t\t\tif (event.deltaY < 0) {\n\t\t\t\tdollyIn(getZoomScale())\n\t\t\t} else if (event.deltaY > 0) {\n\t\t\t\tdollyOut(getZoomScale())\n\t\t\t}\n\n\t\t\tscope.update()\n\t\t}\n\n\t\tfunction handleKeyDown(event: KeyboardEvent): void {\n\t\t\tlet needsUpdate = false\n\n\t\t\tswitch (event.code) {\n\t\t\t\tcase scope.keys.UP:\n\t\t\t\t\tpan(0, scope.keyPanSpeed)\n\t\t\t\t\tneedsUpdate = true\n\t\t\t\t\tbreak\n\n\t\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\t\tpan(0, -scope.keyPanSpeed)\n\t\t\t\t\tneedsUpdate = true\n\t\t\t\t\tbreak\n\n\t\t\t\tcase scope.keys.LEFT:\n\t\t\t\t\tpan(scope.keyPanSpeed, 0)\n\t\t\t\t\tneedsUpdate = true\n\t\t\t\t\tbreak\n\n\t\t\t\tcase scope.keys.RIGHT:\n\t\t\t\t\tpan(-scope.keyPanSpeed, 0)\n\t\t\t\t\tneedsUpdate = true\n\t\t\t\t\tbreak\n\t\t\t\tdefault:\n\t\t\t\t\tbreak\n\t\t\t}\n\n\t\t\tif (needsUpdate) {\n\t\t\t\t// prevent the browser from scrolling on cursor keys\n\t\t\t\tevent.preventDefault()\n\n\t\t\t\tscope.update()\n\t\t\t}\n\t\t}\n\n\t\tfunction handleTouchStartRotate(event: TouchEvent): void {\n\t\t\tif (event.touches.length === 1) {\n\t\t\t\trotateStart.set(event.touches[0].pageX, event.touches[0].pageY)\n\t\t\t} else {\n\t\t\t\tconst x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX)\n\t\t\t\tconst y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY)\n\n\t\t\t\trotateStart.set(x, y)\n\t\t\t}\n\t\t}\n\n\t\tfunction handleTouchStartPan(event: TouchEvent): void {\n\t\t\tif (event.touches.length === 1) {\n\t\t\t\tpanStart.set(event.touches[0].pageX, event.touches[0].pageY)\n\t\t\t} else {\n\t\t\t\tconst x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX)\n\t\t\t\tconst y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY)\n\n\t\t\t\tpanStart.set(x, y)\n\t\t\t}\n\t\t}\n\n\t\tfunction handleTouchStartDolly(event: TouchEvent): void {\n\t\t\tconst dx = event.touches[0].pageX - event.touches[1].pageX\n\t\t\tconst dy = event.touches[0].pageY - event.touches[1].pageY\n\n\t\t\tconst distance = Math.sqrt(dx * dx + dy * dy)\n\n\t\t\tdollyStart.set(0, distance)\n\t\t}\n\n\t\tfunction handleTouchStartDollyPan(event: TouchEvent): void {\n\t\t\tif (scope.enableZoom) handleTouchStartDolly(event)\n\n\t\t\tif (scope.enablePan) handleTouchStartPan(event)\n\t\t}\n\n\t\tfunction handleTouchStartDollyRotate(event: TouchEvent): void {\n\t\t\tif (scope.enableZoom) handleTouchStartDolly(event)\n\n\t\t\tif (scope.enableRotate) handleTouchStartRotate(event)\n\t\t}\n\n\t\tfunction handleTouchMoveRotate(event: TouchEvent): void {\n\t\t\tif (event.touches.length === 1) {\n\t\t\t\trotateEnd.set(event.touches[0].pageX, event.touches[0].pageY)\n\t\t\t} else {\n\t\t\t\tconst x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX)\n\t\t\t\tconst y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY)\n\n\t\t\t\trotateEnd.set(x, y)\n\t\t\t}\n\n\t\t\trotateDelta.subVectors(rotateEnd, rotateStart).multiplyScalar(scope.rotateSpeed)\n\n\t\t\tconst element = scope.domElement\n\n\t\t\trotateLeft((2 * Math.PI * rotateDelta.x) / element.clientHeight) // yes, height\n\n\t\t\trotateUp((2 * Math.PI * rotateDelta.y) / element.clientHeight)\n\n\t\t\trotateStart.copy(rotateEnd)\n\t\t}\n\n\t\tfunction handleTouchMovePan(event: TouchEvent): void {\n\t\t\tif (event.touches.length === 1) {\n\t\t\t\tpanEnd.set(event.touches[0].pageX, event.touches[0].pageY)\n\t\t\t} else {\n\t\t\t\tconst x = 0.5 * (event.touches[0].pageX + event.touches[1].pageX)\n\t\t\t\tconst y = 0.5 * (event.touches[0].pageY + event.touches[1].pageY)\n\n\t\t\t\tpanEnd.set(x, y)\n\t\t\t}\n\n\t\t\tpanDelta.subVectors(panEnd, panStart).multiplyScalar(scope.panSpeed)\n\n\t\t\tpan(panDelta.x, panDelta.y)\n\n\t\t\tpanStart.copy(panEnd)\n\t\t}\n\n\t\tfunction handleTouchMoveDolly(event: TouchEvent): void {\n\t\t\tconst dx = event.touches[0].pageX - event.touches[1].pageX\n\t\t\tconst dy = event.touches[0].pageY - event.touches[1].pageY\n\n\t\t\tconst distance = Math.sqrt(dx * dx + dy * dy)\n\n\t\t\tdollyEnd.set(0, distance)\n\n\t\t\tdollyDelta.set(0, Math.pow(dollyEnd.y / dollyStart.y, scope.zoomSpeed))\n\n\t\t\tdollyOut(dollyDelta.y)\n\n\t\t\tdollyStart.copy(dollyEnd)\n\t\t}\n\n\t\tfunction handleTouchMoveDollyPan(event: TouchEvent): void {\n\t\t\tif (scope.enableZoom) handleTouchMoveDolly(event)\n\n\t\t\tif (scope.enablePan) handleTouchMovePan(event)\n\t\t}\n\n\t\tfunction handleTouchMoveDollyRotate(event: TouchEvent): void {\n\t\t\tif (scope.enableZoom) handleTouchMoveDolly(event)\n\n\t\t\tif (scope.enableRotate) handleTouchMoveRotate(event)\n\t\t}\n\n\t\tfunction handleTouchEnd(event: TouchEvent): void {\n\t\t\t// no-op\n\t\t}\n\n\t\t//\n\t\t// event handlers - FSM: listen for events and reset state\n\t\t//\n\n\t\tfunction onPointerDown(event: PointerEvent): void {\n\t\t\tif (scope.enabled === false) return\n\n\t\t\tswitch (event.pointerType) {\n\t\t\t\tcase 'mouse':\n\t\t\t\tcase 'pen':\n\t\t\t\t\tonMouseDown(event)\n\t\t\t\t\tbreak\n\t\t\t\tdefault:\n\t\t\t\t\tbreak\n\t\t\t\t// TODO touch\n\t\t\t}\n\t\t}\n\n\t\tfunction onPointerMove(event: PointerEvent): void {\n\t\t\tif (scope.enabled === false) return\n\n\t\t\tswitch (event.pointerType) {\n\t\t\t\tcase 'mouse':\n\t\t\t\tcase 'pen':\n\t\t\t\t\tonMouseMove(event)\n\t\t\t\t\tbreak\n\t\t\t\tdefault:\n\t\t\t\t\tbreak\n\t\t\t\t// TODO touch\n\t\t\t}\n\t\t}\n\n\t\tfunction onPointerUp(event: PointerEvent): void {\n\t\t\tswitch (event.pointerType) {\n\t\t\t\tcase 'mouse':\n\t\t\t\tcase 'pen':\n\t\t\t\t\tonMouseUp(event)\n\t\t\t\t\tbreak\n\t\t\t\tdefault:\n\t\t\t\t\tbreak\n\n\t\t\t\t// TODO touch\n\t\t\t}\n\t\t}\n\n\t\tfunction onMouseDown(event: MouseEvent): void {\n\t\t\t// Prevent the browser from scrolling.\n\t\t\tevent.preventDefault()\n\n\t\t\t// Manually set the focus since calling preventDefault above\n\t\t\t// prevents the browser from setting it automatically.\n\n\t\t\tif (scope.domElement.focus) {\n\t\t\t\tscope.domElement.focus()\n\t\t\t} else {\n\t\t\t\twindow.focus()\n\t\t\t}\n\n\t\t\tlet mouseAction\n\n\t\t\tswitch (event.button) {\n\t\t\t\tcase 0:\n\t\t\t\t\tmouseAction = scope.mouseButtons.LEFT\n\t\t\t\t\tbreak\n\n\t\t\t\tcase 1:\n\t\t\t\t\tmouseAction = scope.mouseButtons.MIDDLE\n\t\t\t\t\tbreak\n\n\t\t\t\tcase 2:\n\t\t\t\t\tmouseAction = scope.mouseButtons.RIGHT\n\t\t\t\t\tbreak\n\n\t\t\t\tdefault:\n\t\t\t\t\tmouseAction = -1\n\t\t\t}\n\n\t\t\tswitch (mouseAction) {\n\t\t\t\tcase MOUSE.DOLLY:\n\t\t\t\t\tif (scope.enableZoom === false) return\n\n\t\t\t\t\thandleMouseDownDolly(event)\n\n\t\t\t\t\tstate = STATE.DOLLY\n\n\t\t\t\t\tbreak\n\n\t\t\t\tcase MOUSE.ROTATE:\n\t\t\t\t\tif (event.ctrlKey || event.metaKey || event.shiftKey) {\n\t\t\t\t\t\tif (scope.enablePan === false) return\n\n\t\t\t\t\t\thandleMouseDownPan(event)\n\n\t\t\t\t\t\tstate = STATE.PAN\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (scope.enableRotate === false) return\n\n\t\t\t\t\t\thandleMouseDownRotate(event)\n\n\t\t\t\t\t\tstate = STATE.ROTATE\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak\n\n\t\t\t\tcase MOUSE.PAN:\n\t\t\t\t\tif (event.ctrlKey || event.metaKey || event.shiftKey) {\n\t\t\t\t\t\tif (scope.enableRotate === false) return\n\n\t\t\t\t\t\thandleMouseDownRotate(event)\n\n\t\t\t\t\t\tstate = STATE.ROTATE\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (scope.enablePan === false) return\n\n\t\t\t\t\t\thandleMouseDownPan(event)\n\n\t\t\t\t\t\tstate = STATE.PAN\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak\n\n\t\t\t\tdefault:\n\t\t\t\t\tstate = STATE.NONE\n\t\t\t}\n\n\t\t\tif (state !== STATE.NONE) {\n\t\t\t\tscope.domElement.ownerDocument.addEventListener('pointermove', onPointerMove)\n\t\t\t\tscope.domElement.ownerDocument.addEventListener('pointerup', onPointerUp)\n\n\t\t\t\tscope.dispatchEvent(startEvent)\n\t\t\t}\n\t\t}\n\n\t\tfunction onMouseMove(event: MouseEvent): void {\n\t\t\tif (scope.enabled === false) return\n\n\t\t\tevent.preventDefault()\n\n\t\t\tswitch (state) {\n\t\t\t\tcase STATE.ROTATE:\n\t\t\t\t\tif (scope.enableRotate === false) return\n\n\t\t\t\t\thandleMouseMoveRotate(event)\n\n\t\t\t\t\tbreak\n\n\t\t\t\tcase STATE.DOLLY:\n\t\t\t\t\tif (scope.enableZoom === false) return\n\n\t\t\t\t\thandleMouseMoveDolly(event)\n\n\t\t\t\t\tbreak\n\n\t\t\t\tcase STATE.PAN:\n\t\t\t\t\tif (scope.enablePan === false) return\n\n\t\t\t\t\thandleMouseMovePan(event)\n\n\t\t\t\t\tbreak\n\n\t\t\t\tdefault:\n\t\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tfunction onMouseUp(event: MouseEvent): void {\n\t\t\tscope.domElement.ownerDocument.removeEventListener('pointermove', onPointerMove)\n\t\t\tscope.domElement.ownerDocument.removeEventListener('pointerup', onPointerUp)\n\n\t\t\tif (scope.enabled === false) return\n\n\t\t\thandleMouseUp(event)\n\n\t\t\tscope.dispatchEvent(endEvent)\n\n\t\t\tstate = STATE.NONE\n\t\t}\n\n\t\tfunction onMouseWheel(event: WheelEvent): void {\n\t\t\tif (scope.enabled === false || scope.enableZoom === false || (state !== STATE.NONE && state !== STATE.ROTATE)) return\n\n\t\t\tevent.preventDefault()\n\n\t\t\tscope.dispatchEvent(startEvent)\n\n\t\t\thandleMouseWheel(event)\n\n\t\t\tscope.dispatchEvent(endEvent)\n\t\t}\n\n\t\tfunction onKeyDown(event: KeyboardEvent): void {\n\t\t\tif (scope.enabled === false || scope.enablePan === false) return\n\n\t\t\thandleKeyDown(event)\n\t\t}\n\n\t\tfunction onTouchStart(event: TouchEvent): void {\n\t\t\tif (scope.enabled === false) return\n\n\t\t\tevent.preventDefault() // prevent scrolling\n\n\t\t\tswitch (event.touches.length) {\n\t\t\t\tcase 1:\n\t\t\t\t\tswitch (scope.touches.ONE) {\n\t\t\t\t\t\tcase TOUCH.ROTATE:\n\t\t\t\t\t\t\tif (scope.enableRotate === false) return\n\n\t\t\t\t\t\t\thandleTouchStartRotate(event)\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_ROTATE\n\n\t\t\t\t\t\t\tbreak\n\n\t\t\t\t\t\tcase TOUCH.PAN:\n\t\t\t\t\t\t\tif (scope.enablePan === false) return\n\n\t\t\t\t\t\t\thandleTouchStartPan(event)\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_PAN\n\n\t\t\t\t\t\t\tbreak\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tstate = STATE.NONE\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak\n\n\t\t\t\tcase 2:\n\t\t\t\t\tswitch (scope.touches.TWO) {\n\t\t\t\t\t\tcase TOUCH.DOLLY_PAN:\n\t\t\t\t\t\t\tif (scope.enableZoom === false && scope.enablePan === false) return\n\n\t\t\t\t\t\t\thandleTouchStartDollyPan(event)\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN\n\n\t\t\t\t\t\t\tbreak\n\n\t\t\t\t\t\tcase TOUCH.DOLLY_ROTATE:\n\t\t\t\t\t\t\tif (scope.enableZoom === false && scope.enableRotate === false) return\n\n\t\t\t\t\t\t\thandleTouchStartDollyRotate(event)\n\n\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_ROTATE\n\n\t\t\t\t\t\t\tbreak\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tstate = STATE.NONE\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak\n\n\t\t\t\tdefault:\n\t\t\t\t\tstate = STATE.NONE\n\t\t\t}\n\n\t\t\tif (state !== STATE.NONE) {\n\t\t\t\tscope.dispatchEvent(startEvent)\n\t\t\t}\n\t\t}\n\n\t\tfunction onTouchMove(event: TouchEvent): void {\n\t\t\tif (scope.enabled === false) return\n\n\t\t\tevent.preventDefault() // prevent scrolling\n\n\t\t\tswitch (state) {\n\t\t\t\tcase STATE.TOUCH_ROTATE:\n\t\t\t\t\tif (scope.enableRotate === false) return\n\n\t\t\t\t\thandleTouchMoveRotate(event)\n\n\t\t\t\t\tscope.update()\n\n\t\t\t\t\tbreak\n\n\t\t\t\tcase STATE.TOUCH_PAN:\n\t\t\t\t\tif (scope.enablePan === false) return\n\n\t\t\t\t\thandleTouchMovePan(event)\n\n\t\t\t\t\tscope.update()\n\n\t\t\t\t\tbreak\n\n\t\t\t\tcase STATE.TOUCH_DOLLY_PAN:\n\t\t\t\t\tif (scope.enableZoom === false && scope.enablePan === false) return\n\n\t\t\t\t\thandleTouchMoveDollyPan(event)\n\n\t\t\t\t\tscope.update()\n\n\t\t\t\t\tbreak\n\n\t\t\t\tcase STATE.TOUCH_DOLLY_ROTATE:\n\t\t\t\t\tif (scope.enableZoom === false && scope.enableRotate === false) return\n\n\t\t\t\t\thandleTouchMoveDollyRotate(event)\n\n\t\t\t\t\tscope.update()\n\n\t\t\t\t\tbreak\n\n\t\t\t\tdefault:\n\t\t\t\t\tstate = STATE.NONE\n\t\t\t}\n\t\t}\n\n\t\tfunction onTouchEnd(event: TouchEvent): void {\n\t\t\tif (scope.enabled === false) return\n\n\t\t\thandleTouchEnd(event)\n\n\t\t\tscope.dispatchEvent(endEvent)\n\n\t\t\tstate = STATE.NONE\n\t\t}\n\n\t\tfunction onContextMenu(event: MouseEvent): void {\n\t\t\tif (scope.enabled === false) return\n\n\t\t\tevent.preventDefault()\n\t\t}\n\n\t\t//\n\n\t\tscope.domElement.addEventListener('contextmenu', onContextMenu)\n\n\t\tscope.domElement.addEventListener('pointerdown', onPointerDown)\n\t\tscope.domElement.addEventListener('wheel', onMouseWheel, {\n\t\t\tpassive: false\n\t\t})\n\n\t\tscope.domElement.addEventListener('touchstart', onTouchStart, {\n\t\t\tpassive: false\n\t\t})\n\t\tscope.domElement.addEventListener('touchend', onTouchEnd)\n\t\tscope.domElement.addEventListener('touchmove', onTouchMove, {\n\t\t\tpassive: false\n\t\t})\n\n\t\t// force an update at start\n\n\t\tthis.update()\n\t}\n}\n\nexport default CameraOrbitControls\n","import { MOUSE, PerspectiveCamera, TOUCH } from 'three'\nimport CameraOrbitControls from './cameraOrbitControls'\n\nclass CameraMapControls extends CameraOrbitControls {\n\tconstructor(camera: PerspectiveCamera, domElement: HTMLElement) {\n\t\tsuper(camera, domElement)\n\n\t\tthis.screenSpacePanning = false // pan orthogonal to world-space direction camera.up\n\n\t\tthis.mouseButtons.LEFT = MOUSE.PAN\n\t\tthis.mouseButtons.RIGHT = MOUSE.ROTATE\n\n\t\tthis.touches.ONE = TOUCH.PAN\n\t\tthis.touches.TWO = TOUCH.DOLLY_ROTATE\n\t}\n}\nexport default CameraMapControls\n","import { PerspectiveCamera, Raycaster, Vector2 } from 'three'\nimport { ICordinates } from '../gameObjects/gameObjectWorldData'\nimport GameWorld from '../gameWorld'\n\nclass WorldInteractionControls {\n\tprivate camera: PerspectiveCamera\n\n\tprivate container: HTMLElement\n\n\tprivate gameWorld: GameWorld\n\n\tconstructor(container: HTMLElement, camera: PerspectiveCamera, gameWorld: GameWorld) {\n\t\tthis.container = container\n\t\tthis.camera = camera\n\t\tthis.gameWorld = gameWorld\n\t}\n\n\tpublic initialize = (): void => {\n\t\tthis.container.addEventListener('click', this.handleClick, false)\n\t\tthis.container.addEventListener('contextmenu', this.handleClick, false)\n\t\tthis.container.addEventListener('mousemove', this.handleMouseMove, false)\n\t}\n\n\tgetMouseRaycaster = (event: MouseEvent): Raycaster => {\n\t\tconst raycaster = new Raycaster()\n\t\tconst mouse = new Vector2()\n\t\tmouse.x = (event.clientX / window.innerWidth) * 2 - 1\n\t\tmouse.y = -(event.clientY / window.innerHeight) * 2 + 1\n\n\t\traycaster.setFromCamera(mouse, this.camera)\n\t\treturn raycaster\n\t}\n\n\tprivate handleMouseMove = (event: MouseEvent): void => {\n\t\tevent.preventDefault()\n\t\tconst raycaster = this.getMouseRaycaster(event)\n\t\tconst intersecs = this.gameWorld.getGameObjectIntersection(raycaster)\n\t\tthis.gameWorld.hoverGameObject(intersecs)\n\t}\n\n\tprivate handleClick = (event: MouseEvent): void => {\n\t\tevent.preventDefault()\n\t\tif (event.button === 0) {\n\t\t\tthis.handleLeftClick(event)\n\t\t}\n\t\tif (event.button === 2) {\n\t\t\tthis.handleRightClick(event)\n\t\t}\n\t}\n\n\tprivate handleLeftClick = (event: MouseEvent): void => {\n\t\tconst raycaster = this.getMouseRaycaster(event)\n\t\tconst intersecs = this.gameWorld.getGameObjectIntersection(raycaster)\n\t\tthis.gameWorld.selectGameObject(intersecs, true)\n\t}\n\n\tprivate handleRightClick = (event: MouseEvent): void => {\n\t\tconst raycaster = this.getMouseRaycaster(event)\n\t\tconst intersecs = this.gameWorld.getSceneIntersection(raycaster)\n\t\tif (intersecs && intersecs.length > 0) {\n\t\t\tconst destination: ICordinates = {\n\t\t\t\tx: intersecs[0].point.x,\n\t\t\t\ty: intersecs[0].point.y,\n\t\t\t\tz: intersecs[0].point.z\n\t\t\t}\n\t\t\tthis.gameWorld.setSelectedGameObjectsDestination(destination)\n\t\t}\n\t}\n}\n\nexport default WorldInteractionControls\n","import { PerspectiveCamera } from 'three'\nimport CameraMapControls from './cameraMapControls'\nimport WorldInteractionControls from './worldInteractionControls'\nimport GameWorld from '../gameWorld'\nimport { IUpdate } from '../gameRenderer'\n\nclass GameControls implements IUpdate {\n\tprivate camera: PerspectiveCamera\n\n\tprivate cameraMapControls: CameraMapControls\n\n\tprivate worldInteractionControls: WorldInteractionControls\n\n\tconstructor(container: HTMLElement, camera: PerspectiveCamera, gameWorld: GameWorld) {\n\t\tthis.camera = camera\n\t\tthis.worldInteractionControls = new WorldInteractionControls(container, camera, gameWorld)\n\t\tthis.cameraMapControls = new CameraMapControls(camera, container)\n\t}\n\n\tpublic initialize = (): void => {\n\t\tthis.worldInteractionControls.initialize()\n\n\t\tthis.cameraMapControls.screenSpacePanning = false\n\t\tthis.cameraMapControls.minDistance = 20\n\t\tthis.cameraMapControls.maxDistance = 75\n\n\t\t// \"Math.PI\" = allow full bird view\n\t\t// \"Math.PI / 10\" = allow 10% angle from full bird view\n\t\tthis.cameraMapControls.minPolarAngle = Math.PI / 99\n\n\t\t// \"0\" = allow to look from bottom\n\t\t// \"Math.PI / 2.5\" = lowest look angle is 40%\n\t\tthis.cameraMapControls.maxPolarAngle = Math.PI / 2.5\n\n\t\tthis.cameraMapControls.target.set(0, 0, 0)\n\t\tthis.camera.position.set(32, 68, 0)\n\t\tthis.camera.rotation.set(-1.5, 0, 1.5)\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tpublic update = (timer: number, delta: number): void => {\n\t\tthis.cameraMapControls.update()\n\t}\n}\nexport default GameControls\n","import { Material, Mesh, Object3D } from 'three'\n\nclass Object3DHelper {\n\tpublic static cloneObject3D = (object: Object3D, recursive = true, cloneMaterials = false): Object3D => {\n\t\tconst newObject = object.clone(true)\n\t\tif (recursive) {\n\t\t\tnewObject.traverse((m) => {\n\t\t\t\tconst mesh = m as Mesh\n\t\t\t\tif (mesh.isMesh && cloneMaterials) {\n\t\t\t\t\tmesh.material = Object3DHelper.cloneMaterial(mesh.material)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t\treturn newObject\n\t}\n\n\tpublic static setShadows = (object: Object3D, castShadow = true, receiveShadow = true): Object3D => {\n\t\tobject.traverse((m) => {\n\t\t\tconst mesh = m as Mesh\n\t\t\tmesh.castShadow = castShadow\n\t\t\tmesh.receiveShadow = receiveShadow\n\t\t})\n\t\treturn object\n\t}\n\n\tpublic static cloneMaterial = (material: Material | Material[]): Material | Material[] => {\n\t\tlet newMaterial = material\n\t\tif (Array.isArray(newMaterial)) {\n\t\t\tnewMaterial = newMaterial.filter((im) => im.isMaterial).map((m) => m.clone())\n\t\t} else if (newMaterial.isMaterial) {\n\t\t\tnewMaterial = newMaterial.clone()\n\t\t}\n\t\treturn newMaterial\n\t}\n}\nexport default Object3DHelper\n","var _path, _path2, _path3;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgTowerIcon(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 512 512\",\n    xmlSpace: \"preserve\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M323.84 452.267c-5.12 0-8.533 3.413-8.533 8.533 0 5.12 3.413 8.533 8.533 8.533s8.533-3.413 8.533-8.533c0-5.12-3.413-8.533-8.533-8.533z\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M372.48 129.707 264.107 38.006V8.533c0-5.12-3.413-8.533-8.533-8.533-5.12 0-8.533 3.413-8.533 8.533v30.195l-107.52 90.978c-2.56 2.56-3.413 5.973-2.56 9.387s4.267 5.973 7.68 5.973h8.533v25.6c0 5.12 3.413 8.533 8.533 8.533h8.533v230.4h-8.533c-4.267 0-7.68 3.413-8.533 7.68l-8.533 85.333c0 2.56.853 5.12 2.56 6.827.853 1.707 3.413 2.56 5.973 2.56h204.8c2.56 0 5.12-.853 5.973-2.56 1.707-1.707 2.56-4.267 2.56-6.827l-8.533-85.333c-.853-4.267-4.267-7.68-8.533-7.68h-8.533V179.2h8.533c5.12 0 8.533-3.413 8.533-8.533v-25.6h8.533c3.413 0 6.827-2.56 8.533-5.973.853-3.414 0-6.827-2.56-9.387zM255.573 53.76l87.04 74.24H167.68l87.893-74.24zm93.014 441.173H162.56l6.827-68.267h172.374l6.826 68.267zm-24.747-204.8h-17.067c-5.12 0-8.533 3.413-8.533 8.533s3.413 8.533 8.533 8.533h17.067v102.4H187.307V384h17.067c5.12 0 8.533-3.413 8.533-8.533s-3.413-8.533-8.533-8.533h-17.067V221.867h17.067c5.12 0 8.533-3.413 8.533-8.533 0-5.12-3.413-8.533-8.533-8.533h-17.067v-25.6H323.84v110.932zm17.067-128H170.241v-17.067h170.667v17.067z\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M289.707 452.267h-51.2c-5.12 0-8.533 3.413-8.533 8.533 0 5.12 3.413 8.533 8.533 8.533h51.2c5.12 0 8.533-3.413 8.533-8.533 0-5.12-3.413-8.533-8.533-8.533zM204.373 452.267h-17.067c-5.12 0-8.533 3.413-8.533 8.533 0 5.12 3.413 8.533 8.533 8.533h17.067c5.12 0 8.533-3.413 8.533-8.533.001-5.12-3.413-8.533-8.533-8.533zM238.507 281.6h34.133c5.12 0 8.533-3.413 8.533-8.533V230.4c0-14.507-11.093-25.6-25.6-25.6-14.507 0-25.6 11.093-25.6 25.6v42.667c0 5.12 3.414 8.533 8.534 8.533zm8.533-51.2c0-5.12 3.413-8.533 8.533-8.533 5.12 0 8.533 3.413 8.533 8.533v34.133H247.04V230.4zM238.507 384h34.133c5.12 0 8.533-3.413 8.533-8.533V332.8c0-14.507-11.093-25.6-25.6-25.6-14.507 0-25.6 11.093-25.6 25.6v42.667c0 5.12 3.414 8.533 8.534 8.533zm8.533-51.2c0-5.12 3.413-8.533 8.533-8.533 5.12 0 8.533 3.413 8.533 8.533v34.133H247.04V332.8z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgTowerIcon);\nexport default __webpack_public_path__ + \"static/media/tower-icon.5d90a352.svg\";\nexport { ForwardRef as ReactComponent };","import { PerspectiveCamera, Scene } from 'three'\nimport ModelLoader, { LoadedModels } from './loaders/modelLoader'\nimport { IGameObject } from './gameObjects/gameObject'\nimport MoveableGameObject from './gameObjects/moveableGameObject'\nimport GameStateDataService from './services/gameStateDataService'\nimport { CreateUnitResponse, SetUnitDestination, SetUnitPosition } from './services/models'\nimport GameWorld from './gameWorld'\nimport GameRenderer from './gameRenderer'\nimport GameControls from './controls/gameControls'\nimport Object3DHelper from './helpers/object3dHelper'\n\nclass Game {\n\tprivate scene: Scene\n\n\tprivate camera: PerspectiveCamera\n\n\tprivate gameRenderer: GameRenderer\n\n\tprivate gameControls: GameControls\n\n\tprivate modelLoader: ModelLoader\n\n\tprivate gameWorld: GameWorld\n\n\tprivate gameStateDataService: GameStateDataService\n\n\tconstructor(container: HTMLDivElement) {\n\t\tthis.scene = new Scene()\n\t\tthis.camera = new PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 200)\n\n\t\tthis.gameWorld = new GameWorld(this.scene)\n\t\tthis.gameRenderer = new GameRenderer(container, this.scene, this.camera)\n\t\tthis.gameControls = new GameControls(container, this.camera, this.gameWorld)\n\t\tthis.modelLoader = new ModelLoader('assets/models/')\n\t\tthis.gameStateDataService = new GameStateDataService()\n\t}\n\n\tpublic initialize = (): void => {\n\t\tthis.gameRenderer.initialize()\n\t\tthis.gameControls.initialize()\n\t\tthis.modelLoader.initialize()\n\t\tthis.gameWorld.initialize()\n\n\t\tthis.gameRenderer.addUpdateTarget(this.gameWorld)\n\t\tthis.gameRenderer.addUpdateTarget(this.gameControls)\n\t\tthis.gameWorld.addSetGameObjectWorldDataListener('destination', (id, worldData) => {\n\t\t\tconst { destination } = worldData\n\t\t\tthis.gameStateDataService.setUnitDestination(id, destination.x, destination.z)\n\t\t})\n\t\tthis.loadModels()\n\t}\n\n\tprivate connectToServer = (connectionAtempt = 0): void => {\n\t\tthis.gameStateDataService\n\t\t\t.connectToWebsocket(1)\n\t\t\t.then(() => this.handleConnectedToServer(true, connectionAtempt + 1))\n\t\t\t.catch(() => this.handleConnectedToServer(false, connectionAtempt + 1))\n\t}\n\n\tprivate handleConnectedToServer = (connected: boolean, connectionAtempt = 0): void => {\n\t\tif (connected) {\n\t\t\tthis.gameStateDataService.addMessageHandler('CreateUnit', this.handleServerCreateUnit)\n\t\t\tthis.gameStateDataService.addMessageHandler('SetUnitDestination', this.handleServerSetUnitDestination)\n\t\t\tthis.gameStateDataService.addMessageHandler('SetUnitPosition', this.handleServerSetUnitPosition)\n\n\t\t\tthis.gameRenderer.start()\n\t\t} else {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.connectToServer(connectionAtempt)\n\t\t\t}, 5000 * connectionAtempt)\n\t\t}\n\t}\n\n\tprivate handleServerCreateUnit = (message: CreateUnitResponse): void => {\n\t\tconst { position: pos, id } = message.CreateUnit\n\t\tif (pos.length >= 2) {\n\t\t\tthis.gameWorld.addGameObject(this.createMoveableTower(id, pos[0], pos[1]))\n\t\t}\n\t}\n\n\tprivate handleServerSetUnitPosition = (message: SetUnitPosition): void => {\n\t\tconst { position: pos, id } = message.SetUnitPosition\n\t\tif (pos.length >= 2) {\n\t\t\tthis.gameWorld.setGameObjectWorldData(id, 'position', { x: pos[0], z: pos[1], y: 0.1 })\n\t\t}\n\t}\n\n\tprivate handleServerSetUnitDestination = (message: SetUnitDestination): void => {\n\t\tconst { destination: pos, id } = message.SetUnitDestination\n\t\tif (pos.length >= 2) {\n\t\t\tthis.gameWorld.setGameObjectWorldData(id, 'destination', { x: pos[0], z: pos[1], y: 0.1 })\n\t\t}\n\t}\n\n\tprivate handleLoadModelsCompleted = (): void => {\n\t\tthis.gameStateDataService.fetchInitialGameState().then((resp) => {\n\t\t\tthis.connectToServer()\n\t\t\tObject.keys(resp).forEach((key) => {\n\t\t\t\tconst unit = resp[key]\n\t\t\t\tif (unit.position.length >= 2) {\n\t\t\t\t\tthis.gameWorld.addGameObject(this.createMoveableTower(unit.id, unit.position[0], unit.position[1]))\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tpublic handleActionbarButtonClicked = (button: string): void => {\n\t\tthis.gameStateDataService.createUnit(10, 10)\n\t}\n\n\tprivate loadModels = (): void => {\n\t\tthis.modelLoader.loadModels(\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tname: 'tower',\n\t\t\t\t\tpath: '/tower/scene.gltf',\n\t\t\t\t\tonLoaded: (tower) => tower.object.scale.setScalar(0.03)\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'well',\n\t\t\t\t\tpath: '/well/scene.gltf',\n\t\t\t\t\tonLoaded: (well) => well.object.scale.setScalar(0.3)\n\t\t\t\t}\n\t\t\t],\n\t\t\t() => {\n\t\t\t\tthis.handleLoadModelsCompleted()\n\t\t\t}\n\t\t)\n\t}\n\n\tprivate handleGameObjectReachedDestination = (obj: MoveableGameObject): void => {\n\t\tthis.gameStateDataService.setUnitPosition(obj.key, obj.worldData.position.x, obj.worldData.position.z)\n\t}\n\n\tprivate createMoveableTower = (id: string, posX: number, posZ: number): IGameObject => this.createMoveableGameObject('tower', id, posX, posZ)\n\n\tprivate createMoveableWell = (id: string, posX: number, posZ: number): IGameObject => this.createMoveableGameObject('well', id, posX, posZ)\n\n\tprivate createMoveableGameObject = (modelKey: keyof LoadedModels, id: string, posX: number, posZ: number): IGameObject => {\n\t\tconst model = this.modelLoader.loadedModels[modelKey]\n\t\tconst gameObj = new MoveableGameObject(id, Object3DHelper.setShadows(model.object))\n\t\tgameObj.destinationReached = this.handleGameObjectReachedDestination\n\t\tgameObj.worldData.position.y = 0.1\n\t\tgameObj.worldData.position.x = posX\n\t\tgameObj.worldData.position.z = posZ\n\t\treturn gameObj\n\t}\n}\n\nexport default Game\n","import React, { PureComponent } from 'react'\n\nexport type withSvgIconProps = React.SVGProps<SVGSVGElement>\n\nconst withSvgIcon = <P extends React.SVGProps<SVGSVGElement>>(WrappedSvgIcon: React.ComponentType<P>, defaultProps?: withSvgIconProps): React.ComponentType<P & withSvgIconProps> =>\n\tclass WithSvgIcon extends PureComponent<P & withSvgIconProps> {\n\t\tprivate defaultPropValues: withSvgIconProps = {\n\t\t\tfill: '#336699',\n\t\t\t...defaultProps\n\t\t}\n\n\t\trender(): JSX.Element {\n\t\t\tconst { props } = this\n\t\t\tconst { ...svgProps } = { ...this.defaultPropValues, ...props, className: `with-svg-icon ${props.className}` }\n\t\t\treturn <WrappedSvgIcon {...svgProps} />\n\t\t}\n\t}\n\nexport default withSvgIcon\n","var _path, _path2, _path3;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgWellIcon(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 280.667 280.667\",\n    xmlSpace: \"preserve\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M52.544 280.667h174.424c12.169 0 22.595-7.706 26.65-18.46H25.892c4.057 10.754 14.482 18.46 26.652 18.46zM24.069 231.035h231.374v19.172H24.069zM25.078 219.035h229.357c-3.298-12.057-14.368-20.985-27.467-20.985H52.544c-13.098 0-24.17 8.929-27.466 20.985zM197.552 0H83.332L6.334 87.92h267.999v-.238zM63.06 94.662v97.54h19.491l.01-54.073H129.745a13.715 13.715 0 0 0 10.187 4.521c4.033 0 7.671-1.744 10.187-4.521h47.33v54.073h19.649v-97.54h-19.671l-.023 26.074h-46.446c-2.504-3.366-6.505-5.552-11.025-5.552-4.521 0-8.522 2.186-11.026 5.552H82.595V94.662H63.06zm76.872 26.244c4.419 0 8.011 3.592 8.011 8.011 0 4.418-3.592 8.01-8.011 8.01-4.42 0-8.012-3.592-8.012-8.01 0-4.419 3.592-8.011 8.012-8.011z\"\n  })), _path2 || (_path2 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"m125.269 171.636 4.033 20.612h20.883l3.751-20.612h-11.534v1.271a2.487 2.487 0 0 1-2.483 2.48h-.022a2.487 2.487 0 0 1-2.481-2.48v-1.271h-12.147z\"\n  })), _path3 || (_path3 = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M139.909 174.73a2.004 2.004 0 0 0 2.005-2.005v-24.262a2.005 2.005 0 1 0-4.011 0v24.262c0 1.107.898 2.005 2.006 2.005z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgWellIcon);\nexport default __webpack_public_path__ + \"static/media/well-icon.a58b4836.svg\";\nexport { ForwardRef as ReactComponent };","import './index.scss'\nimport withSvgIcon from './withSvgIcon'\nimport { ReactComponent as TowerIconSVG } from '../../../assets/icons/tower-icon.svg'\nimport { ReactComponent as WellIconSVG } from '../../../assets/icons/well-icon.svg'\n\nconst TowerIcon = withSvgIcon(TowerIconSVG)\nconst WellIcon = withSvgIcon(WellIconSVG)\nexport { TowerIcon, WellIcon }\n","import React, { PureComponent } from 'react'\nimport './basicUI.scss'\nimport { TowerIcon, WellIcon } from '../../../components/ui/icons'\n\ninterface BasicUIProps {\n\tonClickButton: (event: MouseEvent, button: string) => void\n}\nclass BasicUI extends PureComponent<BasicUIProps> {\n\thandleButtonClick =\n\t\t(button: string) =>\n\t\t(event: React.MouseEvent<HTMLButtonElement>): void => {\n\t\t\tevent.preventDefault()\n\t\t\tconst { onClickButton } = this.props\n\t\t\tonClickButton(event.nativeEvent, button)\n\t\t}\n\n\trender = (): JSX.Element => {\n\t\treturn (\n\t\t\t<div className=\"ui-actionbar\">\n\t\t\t\t<button type=\"button\" onClick={this.handleButtonClick('tower')}>\n\t\t\t\t\t<TowerIcon />\n\t\t\t\t</button>\n\t\t\t\t<button type=\"button\" onClick={this.handleButtonClick('well')}>\n\t\t\t\t\t<WellIcon />\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default BasicUI\n","import React, { PureComponent } from 'react'\nimport Game from '../../game'\nimport BasicUI from './components/basicUI'\n\nclass GameContainer extends PureComponent<Record<string, never>> {\n\tprivate initialized = false\n\n\tprivate game: Game | undefined\n\n\tprivate gameContainer: HTMLDivElement | null = null\n\n\tcomponentDidMount(): void {\n\t\tthis.initGame()\n\t}\n\n\tinitGame = (): void => {\n\t\tif (this.gameContainer && !this.initialized) {\n\t\t\tthis.game = new Game(this.gameContainer)\n\t\t\tthis.game.initialize()\n\t\t\tthis.initialized = true\n\t\t}\n\t}\n\n\thandleActionbarButtonClicked = (event: MouseEvent, button: string): void => {\n\t\tif (this.game) {\n\t\t\tthis.game.handleActionbarButtonClicked(button)\n\t\t}\n\t}\n\n\trender = (): JSX.Element => {\n\t\treturn (\n\t\t\t<div className=\"game\">\n\t\t\t\t<div\n\t\t\t\t\tid=\"game-container\"\n\t\t\t\t\tref={(gameContainer): void => {\n\t\t\t\t\t\tthis.gameContainer = gameContainer\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t\t<BasicUI onClickButton={this.handleActionbarButtonClicked} />\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default GameContainer\n","import React, { PureComponent } from 'react'\nimport { Link } from 'react-router-dom'\n\nclass HomeContainer extends PureComponent<Record<string, never>> {\n\trender = (): JSX.Element => {\n\t\treturn (\n\t\t\t<div className=\"home\" style={{ padding: 100 }}>\n\t\t\t\t<Link to=\"/game\" style={{ fontSize: 50 }}>\n\t\t\t\t\tGame\n\t\t\t\t</Link>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default HomeContainer\n","import React, { PureComponent } from 'react'\nimport { HashRouter, Route } from 'react-router-dom'\nimport GameContainer from './game/index'\nimport HomeContainer from './home'\n\nclass App extends PureComponent {\n\trender = (): JSX.Element => {\n\t\treturn (\n\t\t\t<div className=\"App\">\n\t\t\t\t<HashRouter basename={process.env.PUBLIC_URL}>\n\t\t\t\t\t<Route path=\"/\" exact>\n\t\t\t\t\t\t<HomeContainer />\n\t\t\t\t\t</Route>\n\t\t\t\t\t<Route path=\"/game\">\n\t\t\t\t\t\t<GameContainer />\n\t\t\t\t\t</Route>\n\t\t\t\t</HashRouter>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\n\nimport App from './containers'\nimport './styles/index.scss'\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<App />\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n)\n"],"sourceRoot":""}